<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="apple-mobile-web-app-title" content="Home">
    <title>Home</title>

    <!-- Cache Control -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- Preconnect for fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/local/dashboard/images/icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/local/dashboard/images/icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/local/dashboard/images/icon-167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/local/dashboard/images/icon-180.png">

    <!-- Android/PWA -->
    <link rel="manifest" href="/local/dashboard/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/local/dashboard/images/icon-192.png">

    <style>
        /* ============================================
           PREMIUM NEUMORPHIC DESIGN SYSTEM
           Dark Mode with Soft UI + Neon Accents
           ============================================ */

        :root {
            /* Neumorphic Base Colors - Refined Dark Palette */
            --bg-base: #16161e;
            --bg-primary: #1a1a24;
            --bg-secondary: #1e1e2a;
            --bg-tertiary: #242432;
            --bg-elevated: #2a2a3a;
            --bg-surface: #202030;

            /* Neumorphic Shadow Colors */
            --neu-shadow-dark: rgba(0, 0, 0, 0.5);
            --neu-shadow-darker: rgba(0, 0, 0, 0.7);
            --neu-shadow-light: rgba(60, 60, 80, 0.15);
            --neu-shadow-lighter: rgba(80, 80, 100, 0.1);
            --neu-highlight: rgba(255, 255, 255, 0.03);
            --neu-highlight-strong: rgba(255, 255, 255, 0.06);

            /* Neumorphic Depth Levels */
            --neu-raised-sm:
                3px 3px 6px var(--neu-shadow-dark),
                -2px -2px 5px var(--neu-shadow-light);
            --neu-raised-md:
                5px 5px 10px var(--neu-shadow-dark),
                -3px -3px 8px var(--neu-shadow-light);
            --neu-raised-lg:
                8px 8px 16px var(--neu-shadow-darker),
                -4px -4px 12px var(--neu-shadow-light);
            --neu-inset-sm:
                inset 2px 2px 4px var(--neu-shadow-dark),
                inset -2px -2px 4px var(--neu-shadow-light);
            --neu-inset-md:
                inset 4px 4px 8px var(--neu-shadow-dark),
                inset -3px -3px 6px var(--neu-shadow-light);

            /* Text Colors - Higher Contrast for Accessibility */
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --text-tertiary: rgba(255, 255, 255, 0.6);
            --text-muted: rgba(255, 255, 255, 0.4);

            /* Accent Colors - Neon Palette */
            --accent-amber: #fbbf24;
            --accent-emerald: #34d399;
            --accent-red: #f87171;
            --accent-blue: #60a5fa;
            --accent-purple: #c084fc;
            --accent-cyan: #22d3ee;
            --accent-orange: #fb923c;
            --accent-teal: #2dd4bf;
            --accent-pink: #f472b6;

            /* Armed State - Crimson */
            --armed-crimson: #DC143C;
            --armed-crimson-glow: rgba(220, 20, 60, 0.6);
            --armed-crimson-bg: rgba(220, 20, 60, 0.15);

            /* Critical Alerts Only - Pink */
            --alerts-pink: #ec4899;
            --alerts-pink-glow: rgba(236, 72, 153, 0.6);
            --alerts-pink-bg: rgba(236, 72, 153, 0.15);

            /* Neon Glow Effects - Refined */
            --neon-amber:
                0 0 10px rgba(251, 191, 36, 0.4),
                0 0 20px rgba(251, 191, 36, 0.2),
                0 0 40px rgba(251, 191, 36, 0.1);
            --neon-emerald:
                0 0 10px rgba(52, 211, 153, 0.4),
                0 0 20px rgba(52, 211, 153, 0.2),
                0 0 40px rgba(52, 211, 153, 0.1);
            --neon-red:
                0 0 10px rgba(248, 113, 113, 0.4),
                0 0 20px rgba(248, 113, 113, 0.2),
                0 0 40px rgba(248, 113, 113, 0.1);
            --neon-blue:
                0 0 10px rgba(96, 165, 250, 0.4),
                0 0 20px rgba(96, 165, 250, 0.2),
                0 0 40px rgba(96, 165, 250, 0.1);
            --neon-purple:
                0 0 10px rgba(192, 132, 252, 0.4),
                0 0 20px rgba(192, 132, 252, 0.2),
                0 0 40px rgba(192, 132, 252, 0.1);
            --neon-cyan:
                0 0 10px rgba(34, 211, 238, 0.4),
                0 0 20px rgba(34, 211, 238, 0.2),
                0 0 40px rgba(34, 211, 238, 0.1);

            /* Glass/Overlay Effects */
            --glass-bg: rgba(30, 30, 45, 0.6);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-hover: rgba(255, 255, 255, 0.04);

            /* Surface Gradients */
            --surface-gradient: linear-gradient(145deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
            --surface-gradient-subtle: linear-gradient(145deg, rgba(255,255,255,0.02) 0%, transparent 100%);

            /* Safe Areas for iOS */
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
            --safe-left: env(safe-area-inset-left);
            --safe-right: env(safe-area-inset-right);

            /* Spacing */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 16px;
            --spacing-xl: 20px;
            --spacing-2xl: 24px;

            /* Border Radius - Softer for Neumorphism */
            --radius-sm: 10px;
            --radius-md: 14px;
            --radius-lg: 18px;
            --radius-xl: 24px;
            --radius-2xl: 32px;
            --radius-full: 9999px;

            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* ============================================
           BASE RESET & TYPOGRAPHY
           ============================================ */

        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            font-size: 16px;
            line-height: 1.5;
            background: var(--bg-base);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
            height: 100%;
            width: 100%;
            position: fixed;
        }

        /* Neumorphic Base Layer */
        #app {
            background: var(--bg-primary);
        }

        button {
            font-family: inherit;
            border: none;
            background: none;
            cursor: pointer;
            color: inherit;
            -webkit-tap-highlight-color: transparent;
        }

        input {
            font-family: inherit;
            border: none;
            background: none;
            outline: none;
        }

        img {
            max-width: 100%;
            display: block;
        }

        .hidden { display: none !important; }

        /* ============================================
           AMBIENT BACKGROUND
           ============================================ */

        .ambient-bg {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .ambient-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            animation: float 20s ease-in-out infinite;
        }

        .ambient-orb.purple {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.4), transparent 70%);
            top: -100px;
            left: -100px;
            animation-delay: 0s;
        }

        .ambient-orb.blue {
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.3), transparent 70%);
            top: 50%;
            right: -150px;
            animation-delay: -7s;
        }

        .ambient-orb.cyan {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(34, 211, 238, 0.3), transparent 70%);
            bottom: -80px;
            left: 30%;
            animation-delay: -14s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.05); }
            50% { transform: translate(-20px, 20px) scale(0.95); }
            75% { transform: translate(20px, 30px) scale(1.02); }
        }

        /* Grid Pattern Overlay */
        .ambient-bg::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.5;
        }

        /* ============================================
           CONNECTION MODAL - Neumorphic Premium
           ============================================ */

        .connect-modal {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-xl);
            background: var(--bg-base);
        }

        .connect-card {
            width: 100%;
            max-width: 360px;
            padding: var(--spacing-2xl);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-2xl);
            box-shadow: var(--neu-raised-lg);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .connect-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .connect-logo {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-xl);
            background: linear-gradient(145deg, var(--accent-purple), var(--accent-blue));
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow:
                var(--neu-raised-md),
                0 0 30px rgba(168, 85, 247, 0.4),
                0 0 60px rgba(96, 165, 250, 0.2);
        }

        .connect-logo svg {
            width: 40px;
            height: 40px;
            color: white;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .connect-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .connect-subtitle {
            font-size: 0.875rem;
            color: var(--text-tertiary);
            margin-bottom: var(--spacing-xl);
        }

        .connect-input {
            width: 100%;
            padding: var(--spacing-lg);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-md);
            box-shadow: var(--neu-inset-sm);
            color: var(--text-primary);
            font-size: 0.9375rem;
            margin-bottom: var(--spacing-md);
            transition: var(--transition-normal);
        }

        .connect-input:focus {
            border-color: rgba(168, 85, 247, 0.4);
            box-shadow:
                var(--neu-inset-sm),
                0 0 0 3px rgba(168, 85, 247, 0.15);
        }

        .connect-input::placeholder {
            color: var(--text-muted);
        }

        .connect-btn {
            position: relative;
            width: 100%;
            padding: var(--spacing-lg);
            background: linear-gradient(145deg, var(--accent-purple), var(--accent-blue));
            border-radius: var(--radius-md);
            color: white;
            font-size: 1rem;
            font-weight: 700;
            box-shadow:
                var(--neu-raised-md),
                0 0 20px rgba(168, 85, 247, 0.3);
            transition: var(--transition-normal);
            margin-top: var(--spacing-sm);
            overflow: hidden;
        }

        .connect-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .connect-btn:active {
            transform: scale(0.97) translateY(2px);
            box-shadow: var(--neu-inset-sm);
        }

        .connect-btn:active::before {
            opacity: 0;
        }

        .connect-error {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md);
            background: linear-gradient(145deg, rgba(248, 113, 113, 0.1) 0%, rgba(248, 113, 113, 0.05) 100%);
            border: 1px solid rgba(248, 113, 113, 0.2);
            border-radius: var(--radius-md);
            box-shadow: var(--neu-inset-sm);
            color: var(--accent-red);
            font-size: 0.8125rem;
        }

        /* ============================================
           MAIN APP CONTAINER
           ============================================ */

        .mobile-app {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            z-index: 1;
            padding-top: var(--safe-top);
            padding-bottom: var(--safe-bottom);
        }

        .view {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ============================================
           PREMIUM HEADER
           ============================================ */

        .mobile-header {
            flex-shrink: 0;
            padding: var(--spacing-lg) var(--spacing-xl);
            padding-top: calc(var(--spacing-lg) + var(--safe-top));
            background: linear-gradient(180deg, var(--bg-primary) 0%, transparent 100%);
            position: relative;
            z-index: 10;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .time-display {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.8) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .date-display {
            font-size: 0.8125rem;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        /* Weather Badge - Neumorphic */
        .weather-badge {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-full);
            box-shadow: var(--neu-raised-sm);
        }

        .weather-icon {
            width: 20px;
            height: 20px;
            color: var(--accent-amber);
            filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.5));
        }

        .weather-badge span {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        /* Connection Indicator - Neumorphic */
        .connection-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-emerald);
            box-shadow:
                0 0 12px rgba(52, 211, 153, 0.6),
                inset 0 -2px 4px rgba(0, 0, 0, 0.2);
            transition: var(--transition-normal);
        }

        .connection-dot.disconnected {
            background: var(--accent-red);
            box-shadow:
                0 0 12px rgba(248, 113, 113, 0.6),
                inset 0 -2px 4px rgba(0, 0, 0, 0.2);
            animation: pulseDisconnect 2s ease-in-out infinite;
        }

        @keyframes pulseDisconnect {
            0%, 100% { box-shadow: 0 0 12px rgba(248, 113, 113, 0.6), inset 0 -2px 4px rgba(0, 0, 0, 0.2); }
            50% { box-shadow: 0 0 20px rgba(248, 113, 113, 0.8), inset 0 -2px 4px rgba(0, 0, 0, 0.2); }
        }

        /* ============================================
           MAIN CONTENT AREA
           ============================================ */

        .mobile-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0 var(--spacing-xl) var(--spacing-xl);
            padding-bottom: calc(80px + var(--safe-bottom));
            -webkit-overflow-scrolling: touch;
        }

        /* ============================================
           STATUS PILLS - Premium Design
           ============================================ */

        .status-pills {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
        }

        .status-pill {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-md) var(--spacing-sm);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            box-shadow: var(--neu-raised-sm);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        /* Neumorphic inner highlight */
        .status-pill::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--surface-gradient-subtle);
            border-radius: inherit;
            pointer-events: none;
        }

        .status-pill:active {
            transform: scale(0.96) translateY(1px);
            box-shadow: var(--neu-inset-sm);
        }

        .status-pill .icon {
            width: 22px;
            height: 22px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .status-pill .value {
            font-size: 1rem;
            font-weight: 700;
            line-height: 1;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .status-pill .label {
            font-size: 0.6875rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Status Pill States - Neumorphic with Neon Accent */
        .status-pill.lights.active {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.12) 0%, rgba(251, 191, 36, 0.06) 100%);
            border-color: rgba(251, 191, 36, 0.25);
            box-shadow:
                var(--neu-raised-sm),
                0 0 15px rgba(251, 191, 36, 0.2),
                0 0 30px rgba(251, 191, 36, 0.1);
        }

        .status-pill.security.armed {
            background: linear-gradient(145deg, rgba(248, 113, 113, 0.12) 0%, rgba(248, 113, 113, 0.06) 100%);
            border-color: rgba(248, 113, 113, 0.25);
            box-shadow:
                var(--neu-raised-sm),
                0 0 15px rgba(248, 113, 113, 0.2),
                0 0 30px rgba(248, 113, 113, 0.1);
        }

        .status-pill.power {
            background: linear-gradient(145deg, rgba(96, 165, 250, 0.08) 0%, var(--bg-secondary) 100%);
        }

        .status-pill.family {
            background: linear-gradient(145deg, rgba(192, 132, 252, 0.08) 0%, var(--bg-secondary) 100%);
        }

        /* Text Colors */
        .text-amber { color: var(--accent-amber); }
        .text-emerald { color: var(--accent-emerald); }
        .text-red { color: var(--accent-red); }
        .text-blue { color: var(--accent-blue); }
        .text-purple { color: var(--accent-purple); }
        .text-cyan { color: var(--accent-cyan); }
        .text-orange { color: var(--accent-orange); }

        /* ============================================
           QUICK ACCESS BUTTONS - Neumorphic Premium
           ============================================ */

        .quick-access {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .quick-btn {
            position: relative;
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            box-shadow: var(--neu-raised-md);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        /* Neumorphic inner glow */
        .quick-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            border-radius: inherit;
            pointer-events: none;
        }

        /* Subtle edge highlight */
        .quick-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
            pointer-events: none;
        }

        .quick-btn:active {
            transform: scale(0.97) translateY(2px);
            box-shadow: var(--neu-inset-sm);
        }

        .quick-btn:active::before {
            opacity: 0;
        }

        .quick-btn.open {
            background: linear-gradient(145deg, rgba(16, 185, 129, 0.12) 0%, rgba(16, 185, 129, 0.06) 100%);
            border-color: rgba(16, 185, 129, 0.25);
            box-shadow:
                var(--neu-raised-md),
                0 0 20px rgba(16, 185, 129, 0.15);
        }

        .quick-btn .btn-icon {
            position: relative;
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: var(--neu-inset-sm);
            transition: var(--transition-normal);
        }

        .quick-btn .btn-icon svg {
            width: 24px;
            height: 24px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .quick-btn .btn-icon.gate {
            background: linear-gradient(145deg, rgba(168, 85, 247, 0.15) 0%, rgba(168, 85, 247, 0.08) 100%);
            color: var(--accent-purple);
        }

        .quick-btn .btn-icon.garage {
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%);
            color: var(--accent-blue);
        }

        .quick-btn:active .btn-icon {
            box-shadow:
                inset 1px 1px 2px var(--neu-shadow-dark),
                inset -1px -1px 2px var(--neu-shadow-light);
        }

        .quick-btn .btn-text {
            flex: 1;
            text-align: left;
        }

        .quick-btn .btn-name {
            font-size: 0.9375rem;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .quick-btn .btn-status {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        /* ============================================
           SECTION HEADERS - Neumorphic
           ============================================ */

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .section-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .floor-toggle {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            padding: 3px;
            box-shadow: var(--neu-inset-sm);
        }

        .floor-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-tertiary);
            transition: var(--transition-normal);
        }

        .floor-btn:active {
            transform: scale(0.95);
        }

        .floor-btn.active {
            background: var(--bg-secondary);
            color: var(--text-primary);
            box-shadow: var(--neu-raised-sm);
        }

        /* ============================================
           ROOMS GRID - Neumorphic Premium Cards
           ============================================ */

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
        }

        .room-card {
            position: relative;
            display: flex;
            flex-direction: column;
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            min-height: 100px;
            box-shadow: var(--neu-raised-md);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        /* Neumorphic surface gradient */
        .room-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 40%);
            border-radius: inherit;
            pointer-events: none;
            z-index: 1;
        }

        /* Top edge highlight */
        .room-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 10%;
            right: 10%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            pointer-events: none;
            z-index: 2;
        }

        .room-card:active {
            transform: scale(0.96) translateY(2px);
            box-shadow: var(--neu-inset-md);
        }

        .room-card:active::before {
            opacity: 0;
        }

        /* Room card with lights ON - Neumorphic + Neon Fusion */
        .room-card.has-lights-on {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.08) 0%, var(--bg-secondary) 100%);
            border-color: rgba(251, 191, 36, 0.3);
            box-shadow:
                var(--neu-raised-md),
                0 0 25px rgba(251, 191, 36, 0.2),
                0 0 50px rgba(251, 191, 36, 0.1),
                inset 0 0 30px rgba(251, 191, 36, 0.03);
            animation: roomNeonGlowNeu 3s ease-in-out infinite;
        }

        .room-card.has-lights-on::before {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.08) 0%, transparent 60%);
        }

        @keyframes roomNeonGlowNeu {
            0%, 100% {
                box-shadow:
                    var(--neu-raised-md),
                    0 0 25px rgba(251, 191, 36, 0.2),
                    0 0 50px rgba(251, 191, 36, 0.1),
                    inset 0 0 30px rgba(251, 191, 36, 0.03);
            }
            50% {
                box-shadow:
                    var(--neu-raised-md),
                    0 0 35px rgba(251, 191, 36, 0.3),
                    0 0 70px rgba(251, 191, 36, 0.15),
                    inset 0 0 40px rgba(251, 191, 36, 0.05);
            }
        }

        .room-card.has-lights-on .room-icon {
            box-shadow:
                var(--neu-inset-sm),
                0 0 15px rgba(251, 191, 36, 0.5);
        }

        .room-card.has-lights-on .room-status {
            color: var(--accent-amber);
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .room-card-bg {
            --room-bg-image: none;
        }

        .room-card-bg .room-bg {
            position: absolute;
            inset: 0;
            background: var(--room-bg-image);
            background-size: cover;
            background-position: center;
            opacity: 0.15;
        }

        .room-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .room-icon {
            position: relative;
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--neu-inset-sm);
            transition: var(--transition-normal);
            z-index: 2;
        }

        .room-icon svg {
            width: 22px;
            height: 22px;
            color: white;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        /* Room Icon Colors - Enhanced with neumorphic depth */
        .room-icon.amber {
            background: linear-gradient(145deg, rgba(245, 158, 11, 0.25) 0%, rgba(245, 158, 11, 0.12) 100%);
            color: var(--accent-amber);
        }
        .room-icon.blue {
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.25) 0%, rgba(59, 130, 246, 0.12) 100%);
            color: var(--accent-blue);
        }
        .room-icon.purple {
            background: linear-gradient(145deg, rgba(168, 85, 247, 0.25) 0%, rgba(168, 85, 247, 0.12) 100%);
            color: var(--accent-purple);
        }
        .room-icon.emerald {
            background: linear-gradient(145deg, rgba(16, 185, 129, 0.25) 0%, rgba(16, 185, 129, 0.12) 100%);
            color: var(--accent-emerald);
        }
        .room-icon.cyan {
            background: linear-gradient(145deg, rgba(34, 211, 238, 0.25) 0%, rgba(34, 211, 238, 0.12) 100%);
            color: var(--accent-cyan);
        }
        .room-icon.orange {
            background: linear-gradient(145deg, rgba(249, 115, 22, 0.25) 0%, rgba(249, 115, 22, 0.12) 100%);
            color: var(--accent-orange);
        }
        .room-icon.pink {
            background: linear-gradient(145deg, rgba(236, 72, 153, 0.25) 0%, rgba(236, 72, 153, 0.12) 100%);
            color: var(--accent-pink);
        }
        .room-icon.teal {
            background: linear-gradient(145deg, rgba(20, 184, 166, 0.25) 0%, rgba(20, 184, 166, 0.12) 100%);
            color: var(--accent-teal);
        }
        .room-icon.red {
            background: linear-gradient(145deg, rgba(239, 68, 68, 0.25) 0%, rgba(239, 68, 68, 0.12) 100%);
            color: var(--accent-red);
        }

        .room-name {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .room-status {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .lights-count {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            width: 24px;
            height: 24px;
            background: var(--accent-amber);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: black;
            box-shadow: var(--glow-amber);
        }

        /* ============================================
           CAMERAS VIEW - Neumorphic Premium
           ============================================ */

        .cameras-stack {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .camera-card {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            border-radius: var(--radius-xl);
            overflow: hidden;
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: var(--neu-raised-lg);
            transition: var(--transition-normal);
        }

        .camera-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: linear-gradient(145deg, rgba(255,255,255,0.02) 0%, transparent 30%);
            pointer-events: none;
            z-index: 2;
        }

        .camera-card:active {
            transform: scale(0.98);
            box-shadow: var(--neu-raised-sm);
        }

        .camera-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(0,0,0,0.5) 0%, transparent 35%, transparent 55%, rgba(0,0,0,0.75) 100%);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: var(--spacing-lg);
            z-index: 3;
        }

        .live-badge {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            background: rgba(239, 68, 68, 0.9);
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-full);
            width: fit-content;
            box-shadow:
                0 2px 8px rgba(239, 68, 68, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            animation: pulseLive 1.5s ease-in-out infinite;
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.8);
        }

        @keyframes pulseLive {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(0.85); }
        }

        .camera-name {
            font-size: 1.25rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        .camera-status {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .tap-hint {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            margin-top: var(--spacing-xs);
        }

        /* ============================================
           SECURITY VIEW - Neumorphic Premium
           ============================================ */

        .security-status-card {
            position: relative;
            padding: var(--spacing-xl);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--neu-raised-md);
            overflow: hidden;
        }

        /* Left accent stripe */
        .security-status-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--accent-emerald);
            box-shadow: 0 0 15px rgba(52, 211, 153, 0.5);
        }

        /* Top gradient highlight */
        .security-status-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .security-status-card.armed-home::before {
            background: var(--accent-amber);
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .security-status-card.armed-home {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.08) 0%, var(--bg-secondary) 100%);
        }

        .security-status-card.armed-away::before {
            background: var(--armed-crimson);
            box-shadow: 0 0 20px var(--armed-crimson-glow);
        }

        .security-status-card.armed-away {
            background: linear-gradient(145deg, var(--armed-crimson-bg) 0%, var(--bg-secondary) 100%);
        }

        /* Critical Alerts Only - Pink styling */
        .security-status-card.alerts-only::before {
            background: var(--alerts-pink);
            box-shadow: 0 0 20px var(--alerts-pink-glow);
        }

        .security-status-card.alerts-only {
            background: linear-gradient(145deg, var(--alerts-pink-bg) 0%, var(--bg-secondary) 100%);
        }

        /* Armed state indicator with heartbeat animation */
        .security-armed-indicator {
            position: relative;
            background: var(--armed-crimson-bg) !important;
            border-color: var(--armed-crimson) !important;
        }

        .security-armed-indicator svg {
            color: var(--armed-crimson) !important;
            animation: shieldHeartbeat 1.5s ease-in-out infinite;
        }

        /* Wave rings emanating from shield */
        .security-armed-indicator::before,
        .security-armed-indicator::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            border: 2px solid var(--armed-crimson);
            animation: wavePropagate 2s ease-out infinite;
            pointer-events: none;
        }

        .security-armed-indicator::after {
            animation-delay: 1s;
        }

        /* Critical Alerts Only - Pink heartbeat indicator */
        .security-alerts-indicator {
            position: relative;
            background: var(--alerts-pink-bg) !important;
            border-color: var(--alerts-pink) !important;
        }

        .security-alerts-indicator svg {
            color: var(--alerts-pink) !important;
            animation: shieldHeartbeat 1.5s ease-in-out infinite;
        }

        .security-alerts-indicator::before,
        .security-alerts-indicator::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            border: 2px solid var(--alerts-pink);
            animation: wavePropagate 2s ease-out infinite;
            pointer-events: none;
        }

        .security-alerts-indicator::after {
            animation-delay: 1s;
        }

        /* Heartbeat pulse animation */
        @keyframes shieldHeartbeat {
            0%, 100% { transform: scale(1); }
            15% { transform: scale(1.08); }
            30% { transform: scale(1); }
            45% { transform: scale(1.05); }
            60% { transform: scale(1); }
        }

        /* Wave propagation animation */
        @keyframes wavePropagate {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        /* Armed text styling - high contrast white */
        .security-armed-text {
            color: #ffffff !important;
            font-weight: 700 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5), 0 0 20px var(--armed-crimson-glow);
        }

        .alarm-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .alarm-btn {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-xl);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            box-shadow: var(--neu-raised-md);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .alarm-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .alarm-btn:active {
            transform: scale(0.96) translateY(2px);
            box-shadow: var(--neu-inset-sm);
        }

        .alarm-btn:active::before {
            opacity: 0;
        }

        .alarm-btn svg {
            width: 32px;
            height: 32px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .alarm-btn.stay svg {
            color: var(--accent-amber);
            filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.4));
        }
        .alarm-btn.away svg {
            color: var(--accent-red);
            filter: drop-shadow(0 0 8px rgba(248, 113, 113, 0.4));
        }
        .alarm-btn.outside svg {
            color: var(--accent-blue);
            filter: drop-shadow(0 0 8px rgba(96, 165, 250, 0.4));
        }
        .alarm-btn.disarm svg {
            color: var(--accent-emerald);
            filter: drop-shadow(0 0 8px rgba(52, 211, 153, 0.4));
        }

        .alarm-btn span {
            font-size: 0.875rem;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        /* Zones List - Neumorphic */
        .zones-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .zone-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-md);
            box-shadow: var(--neu-raised-sm);
            transition: var(--transition-normal);
        }

        .zone-item:active {
            box-shadow: var(--neu-inset-sm);
        }

        .zone-item.zone-red {
            background: linear-gradient(145deg, rgba(248, 113, 113, 0.08) 0%, var(--bg-secondary) 100%);
            border-color: rgba(248, 113, 113, 0.15);
        }

        .zone-item.zone-amber {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.08) 0%, var(--bg-secondary) 100%);
            border-color: rgba(251, 191, 36, 0.15);
        }

        .zone-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-tertiary);
            box-shadow: var(--neu-inset-sm);
        }

        .zone-icon svg {
            width: 18px;
            height: 18px;
            color: var(--text-secondary);
        }

        .zone-icon-red svg {
            color: var(--accent-red);
            filter: drop-shadow(0 0 6px rgba(248, 113, 113, 0.5));
        }
        .zone-icon-amber svg {
            color: var(--accent-amber);
            filter: drop-shadow(0 0 6px rgba(251, 191, 36, 0.5));
        }
        .zone-icon-emerald svg {
            color: var(--accent-emerald);
            filter: drop-shadow(0 0 6px rgba(52, 211, 153, 0.5));
        }

        .zone-name {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .zone-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .zone-time {
            font-size: 0.625rem;
            color: var(--accent-amber);
            font-weight: 500;
        }

        .zone-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--text-muted);
            transition: var(--transition-normal);
        }

        .zone-status.status-red {
            background: var(--accent-red);
            box-shadow: 0 0 12px rgba(248, 113, 113, 0.6);
            animation: pulseStatus 2s ease-in-out infinite;
        }

        .zone-status.status-amber {
            background: var(--accent-amber);
            box-shadow: 0 0 12px rgba(251, 191, 36, 0.6);
        }

        .zone-status.status-emerald {
            background: var(--accent-emerald);
            box-shadow: 0 0 8px rgba(52, 211, 153, 0.4);
        }

        @keyframes pulseStatus {
            0%, 100% { box-shadow: 0 0 12px rgba(248, 113, 113, 0.6); }
            50% { box-shadow: 0 0 20px rgba(248, 113, 113, 0.8); }
        }

        /* ============================================
           ENERGY VIEW - Neumorphic Neo-Futuristic
           ============================================ */

        .energy-overview {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .energy-card-neo {
            position: relative;
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            box-shadow: var(--neu-raised-md);
            overflow: hidden;
            transition: var(--transition-normal);
        }

        /* Top accent stripe with glow */
        .energy-card-neo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        /* Surface gradient */
        .energy-card-neo::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .energy-card-neo:active {
            transform: scale(0.97);
            box-shadow: var(--neu-inset-sm);
        }

        .energy-card-neo.solar::before {
            background: linear-gradient(90deg, var(--accent-amber), var(--accent-orange));
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.4);
        }

        .energy-card-neo.battery::before {
            background: linear-gradient(90deg, var(--accent-emerald), var(--accent-teal));
            box-shadow: 0 0 15px rgba(52, 211, 153, 0.4);
        }

        .energy-card-neo.grid::before {
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
            box-shadow: 0 0 15px rgba(96, 165, 250, 0.4);
        }

        .energy-card-neo.load::before {
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-pink));
            box-shadow: 0 0 15px rgba(192, 132, 252, 0.4);
        }

        .energy-card-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
            position: relative;
            z-index: 1;
        }

        .energy-card-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--neu-inset-sm);
        }

        .energy-card-icon svg {
            width: 18px;
            height: 18px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .energy-card-neo.solar .energy-card-icon {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.2) 0%, rgba(251, 191, 36, 0.1) 100%);
            color: var(--accent-amber);
        }

        .energy-card-neo.battery .energy-card-icon {
            background: linear-gradient(145deg, rgba(52, 211, 153, 0.2) 0%, rgba(52, 211, 153, 0.1) 100%);
            color: var(--accent-emerald);
        }

        .energy-card-neo.grid .energy-card-icon {
            background: linear-gradient(145deg, rgba(96, 165, 250, 0.2) 0%, rgba(96, 165, 250, 0.1) 100%);
            color: var(--accent-blue);
        }

        .energy-card-neo.load .energy-card-icon {
            background: linear-gradient(145deg, rgba(192, 132, 252, 0.2) 0%, rgba(192, 132, 252, 0.1) 100%);
            color: var(--accent-purple);
        }

        .energy-card-label {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: relative;
            z-index: 1;
        }

        .energy-card-value {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.2;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .energy-card-sub {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            position: relative;
            z-index: 1;
        }

        /* Battery Bar - Neumorphic */
        .battery-bar-container {
            position: relative;
            margin-top: var(--spacing-sm);
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            box-shadow: var(--neu-inset-sm);
            overflow: hidden;
            z-index: 1;
        }

        .battery-bar-fill {
            height: 100%;
            border-radius: var(--radius-full);
            background: linear-gradient(90deg, var(--accent-emerald), var(--accent-teal));
            box-shadow: 0 0 10px rgba(52, 211, 153, 0.5);
            transition: width 0.3s ease;
        }

        /* Power Trend Chart - Neumorphic */
        .chart-card {
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-lg);
            box-shadow: var(--neu-raised-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            position: relative;
            overflow: hidden;
        }

        .chart-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.02) 0%, transparent 50%);
            pointer-events: none;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .chart-title {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .chart-legend {
            display: flex;
            gap: var(--spacing-md);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: 0.6875rem;
            color: var(--text-tertiary);
        }

        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .legend-dot.actual {
            background: var(--accent-cyan);
            box-shadow: 0 0 6px rgba(34, 211, 238, 0.5);
        }

        .legend-dot.avg {
            background: var(--accent-purple);
            opacity: 0.5;
        }

        .chart-container {
            position: relative;
            height: 120px;
        }

        .chart-container canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .chart-time-labels {
            display: flex;
            justify-content: space-between;
            padding-top: var(--spacing-sm);
            font-size: 0.625rem;
            color: var(--text-muted);
        }

        /* Appliances Section */
        .appliances-title {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--spacing-md);
        }

        .appliances-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
        }

        .appliance-card {
            position: relative;
            padding: var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: var(--radius-md);
            box-shadow: var(--neu-raised-sm);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .appliance-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.02) 0%, transparent 50%);
            pointer-events: none;
        }

        .appliance-card:active {
            transform: scale(0.97);
            box-shadow: var(--neu-inset-sm);
        }

        .appliance-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
            position: relative;
            z-index: 1;
        }

        .appliance-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--neu-inset-sm);
        }

        .appliance-icon svg {
            width: 20px;
            height: 20px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .appliance-name {
            font-size: 0.8125rem;
            font-weight: 500;
            margin-bottom: var(--spacing-xs);
            position: relative;
            z-index: 1;
        }

        .appliance-power {
            font-size: 1.25rem;
            font-weight: 700;
            position: relative;
            z-index: 1;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .appliance-status {
            font-size: 0.6875rem;
            color: var(--text-tertiary);
            position: relative;
            z-index: 1;
        }

        /* Toggle Switch - Neumorphic */
        .toggle-switch {
            width: 48px;
            height: 26px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-full);
            position: relative;
            box-shadow: var(--neu-inset-sm);
            transition: var(--transition-normal);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: linear-gradient(145deg, #ffffff, #e0e0e0);
            border-radius: 50%;
            box-shadow:
                2px 2px 4px rgba(0, 0, 0, 0.2),
                -1px -1px 2px rgba(255, 255, 255, 0.1);
            transition: var(--transition-normal);
        }

        .toggle-switch.on {
            background: linear-gradient(145deg, var(--accent-emerald), rgba(52, 211, 153, 0.8));
            box-shadow:
                var(--neu-inset-sm),
                0 0 15px rgba(52, 211, 153, 0.4);
        }

        .toggle-switch.on::after {
            transform: translateX(22px);
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
        }

        /* ============================================
           BOTTOM NAVIGATION - Neumorphic Premium
           ============================================ */

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            padding: var(--spacing-md) var(--spacing-lg);
            padding-bottom: calc(var(--spacing-md) + var(--safe-bottom));
            background: var(--bg-primary);
            border-top: 1px solid rgba(255, 255, 255, 0.03);
            box-shadow:
                0 -8px 20px rgba(0, 0, 0, 0.3),
                0 -2px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
            z-index: 100;
        }

        .nav-item {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--radius-lg);
            transition: var(--transition-normal);
            color: var(--text-tertiary);
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
            transition: var(--transition-normal);
        }

        .nav-item span {
            font-size: 0.625rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .nav-item:active {
            transform: scale(0.92);
        }

        .nav-item.active {
            color: var(--accent-cyan);
            background: var(--bg-secondary);
            box-shadow: var(--neu-inset-sm);
        }

        .nav-item.active svg {
            filter: drop-shadow(0 0 8px rgba(34, 211, 238, 0.6));
        }

        .nav-item.active span {
            text-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }

        /* Nav item glow effect on active */
        .nav-item.active::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: var(--radius-lg);
            background: linear-gradient(145deg, rgba(34, 211, 238, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        /* ============================================
           MODAL SHEETS - Premium Bottom Sheet
           ============================================ */

        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 200;
        }

        .modal-sheet {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-height: 80vh;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            z-index: 201;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            padding-bottom: var(--safe-bottom);
        }

        .modal-sheet.open {
            transform: translateY(0);
        }

        .modal-handle {
            width: 40px;
            height: 4px;
            background: var(--text-muted);
            border-radius: var(--radius-full);
            margin: var(--spacing-md) auto;
            flex-shrink: 0;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--spacing-xl) var(--spacing-lg);
            flex-shrink: 0;
        }

        .modal-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass-bg);
            border-radius: 50%;
        }

        .modal-close svg {
            width: 18px;
            height: 18px;
            color: var(--text-secondary);
        }

        .modal-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 var(--spacing-xl) var(--spacing-xl);
            -webkit-overflow-scrolling: touch;
        }

        /* Master Controls */
        .master-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .master-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition-fast);
        }

        .master-btn.all-on {
            background: rgba(245, 158, 11, 0.1);
            color: var(--accent-amber);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .master-btn.all-off {
            background: rgba(239, 68, 68, 0.1);
            color: var(--accent-red);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .master-btn:active {
            transform: scale(0.97);
        }

        /* Light Grid */
        .light-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-sm);
        }

        .light-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .light-btn:active {
            transform: scale(0.95);
        }

        .light-btn.on {
            background: rgba(245, 158, 11, 0.15);
            border-color: rgba(245, 158, 11, 0.3);
        }

        .light-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .light-icon svg {
            width: 20px;
            height: 20px;
            color: var(--text-secondary);
        }

        .light-btn.on .light-icon {
            background: var(--accent-amber);
            box-shadow: var(--glow-amber);
        }

        .light-btn.on .light-icon svg {
            color: black;
        }

        .light-name {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-align: center;
            line-height: 1.2;
        }

        .light-btn.on .light-name {
            color: var(--text-primary);
        }

        /* Glass Effect */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
        }

        /* ============================================
           FAMILY VIEW - iOS Premium Redesign
           Clean, minimal, Apple-inspired
           ============================================ */

        /* Family View Layout */
        #view-family {
            background: var(--bg-primary);
        }

        #view-family .mobile-header {
            padding: var(--spacing-lg) var(--spacing-xl);
            padding-top: calc(var(--spacing-lg) + var(--safe-top));
            background: transparent;
        }

        #view-family .mobile-content {
            padding: 0 var(--spacing-xl);
            padding-bottom: calc(var(--safe-bottom) + 100px);
        }

        /* Family Header - Clean iOS style */
        .family-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .family-title {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            color: var(--text-primary);
        }

        .family-subtitle {
            font-size: 0.8125rem;
            color: var(--text-tertiary);
            margin-top: 2px;
        }

        /* Battery Alerts - Compact pill style */
        .battery-alerts-container {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .battery-alert {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 8px 14px;
            border-radius: var(--radius-full);
            animation: fadeSlideIn 0.4s ease-out;
        }

        .battery-alert.warning {
            background: rgba(245, 158, 11, 0.15);
        }

        .battery-alert.critical {
            background: rgba(239, 68, 68, 0.2);
            animation: criticalPulse 2s ease-in-out infinite;
        }

        .battery-alert-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }

        .battery-alert-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .battery-alert-text {
            font-size: 0.8125rem;
            font-weight: 500;
        }

        .battery-alert.warning .battery-alert-text { color: var(--accent-amber); }
        .battery-alert.critical .battery-alert-text { color: var(--accent-red); }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes criticalPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Who's Home - Hero Card */
        .family-home-hero {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.12) 0%, rgba(16, 185, 129, 0.04) 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
            position: relative;
            overflow: hidden;
        }

        .family-home-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.15), transparent 70%);
            pointer-events: none;
        }

        .home-hero-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .home-hero-left {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .home-hero-label {
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--accent-emerald);
            opacity: 0.8;
        }

        .home-hero-count {
            font-size: 3rem;
            font-weight: 800;
            letter-spacing: -0.04em;
            color: var(--text-primary);
            line-height: 1;
        }

        .home-hero-names {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Stacked Avatars - iOS style */
        .home-avatars-stack {
            display: flex;
            flex-direction: row-reverse;
        }

        .home-avatars-stack .stack-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 3px solid var(--bg-primary);
            overflow: hidden;
            margin-left: -16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease;
        }

        .home-avatars-stack .stack-avatar:first-child {
            margin-left: 0;
        }

        .home-avatars-stack .stack-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .home-avatars-stack .stack-avatar-initial {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.125rem;
            color: white;
        }

        /* Section Label - iOS style */
        .family-section-label {
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: var(--spacing-md);
            padding-left: 2px;
        }

        /* Family Member Cards - Grid Layout */
        .family-cards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-2xl);
        }

        .family-member-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: var(--spacing-lg);
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .family-member-card:active {
            transform: scale(0.97);
        }

        .family-member-card.is-home {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08) 0%, var(--glass-bg) 100%);
            border-color: rgba(16, 185, 129, 0.2);
        }

        .family-member-card.is-away {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.06) 0%, var(--glass-bg) 100%);
            border-color: rgba(249, 115, 22, 0.15);
        }

        /* Member Card Header - Generated by JS */
        .member-card-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .member-avatar {
            position: relative;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--member-color, var(--accent-cyan));
            overflow: hidden;
            flex-shrink: 0;
        }

        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .member-status-badge {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--bg-primary);
        }

        .member-status-badge.home {
            background: var(--accent-emerald);
        }

        .member-status-badge.away {
            background: var(--accent-orange);
        }

        .member-status-badge svg {
            width: 10px;
            height: 10px;
            fill: white;
        }

        /* Battery Section */
        .member-battery {
            margin-bottom: var(--spacing-md);
            padding: var(--spacing-sm) 0;
        }

        .battery-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-xs);
        }

        .battery-label {
            display: flex;
            align-items: center;
            color: var(--text-tertiary);
        }

        .battery-label svg {
            width: 14px;
            height: 14px;
        }

        .battery-value {
            font-size: 0.8125rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .battery-value.good { color: var(--accent-emerald); }
        .battery-value.medium { color: var(--accent-amber); }
        .battery-value.low { color: var(--accent-red); }

        .battery-value .charging-icon {
            width: 12px;
            height: 12px;
            color: var(--accent-amber);
        }

        .battery-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .battery-bar-fill {
            height: 100%;
            border-radius: var(--radius-full);
            transition: width 0.3s ease;
        }

        /* Member Stats Grid */
        .member-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-xs);
            padding-top: var(--spacing-sm);
            border-top: 1px solid rgba(255, 255, 255, 0.06);
        }

        .member-stat {
            text-align: center;
        }

        /* Member Card - Avatar Section (Legacy) */
        .member-card-top {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
        }

        .member-avatar-ring {
            position: relative;
            width: 52px;
            height: 52px;
        }

        /* Activity Ring - Apple Watch style */
        .member-ring-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 52px;
            height: 52px;
            transform: rotate(-90deg);
        }

        .member-ring-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.06);
            stroke-width: 3;
        }

        .member-ring-progress {
            fill: none;
            stroke-width: 3;
            stroke-linecap: round;
            transition: stroke-dasharray 0.8s ease;
        }

        .member-avatar-img {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid var(--bg-primary);
        }

        .member-avatar-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .member-avatar-img .avatar-initial {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            color: white;
        }

        /* Status Indicator */
        .member-status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            box-shadow: 0 0 8px currentColor;
        }

        .member-status-dot.home {
            background: var(--accent-emerald);
            color: var(--accent-emerald);
        }

        .member-status-dot.away {
            background: var(--accent-orange);
            color: var(--accent-orange);
        }

        /* Member Info */
        .member-card-info {
            margin-bottom: var(--spacing-sm);
        }

        .member-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .member-location {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .member-location svg {
            width: 10px;
            height: 10px;
            opacity: 0.6;
        }

        /* Member Stats Row */
        .member-stats-row {
            display: flex;
            gap: var(--spacing-md);
            padding-top: var(--spacing-sm);
            border-top: 1px solid rgba(255, 255, 255, 0.06);
        }

        .member-stat-item {
            flex: 1;
            text-align: center;
        }

        .member-stat-value {
            font-size: 0.9375rem;
            font-weight: 700;
            line-height: 1;
        }

        .member-stat-value.steps { color: var(--accent-amber); }
        .member-stat-value.battery { color: var(--accent-emerald); }
        .member-stat-value.battery.low { color: var(--accent-red); }
        .member-stat-value.battery.medium { color: var(--accent-amber); }

        .member-stat-label {
            font-size: 0.5625rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 3px;
        }

        /* Focus Badge */
        .focus-badge {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            padding: 3px 8px;
            background: rgba(168, 85, 247, 0.2);
            border-radius: var(--radius-full);
            font-size: 0.5625rem;
            font-weight: 600;
            color: var(--accent-purple);
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .focus-badge svg {
            width: 9px;
            height: 9px;
        }

        /* Steps Competition Section */
        .steps-competition {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(245, 158, 11, 0.02) 100%);
            border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: var(--radius-xl);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-2xl);
        }

        .steps-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-lg);
        }

        .steps-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .steps-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-md);
            background: rgba(245, 158, 11, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-amber);
        }

        .steps-icon svg {
            width: 18px;
            height: 18px;
        }

        .steps-title-text {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .steps-total {
            text-align: right;
        }

        .steps-total-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-amber);
        }

        .steps-total-label {
            font-size: 0.625rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Steps Leaderboard */
        .steps-leaderboard {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-lg);
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .leaderboard-item:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.06);
        }

        .leaderboard-item.rank-1 {
            background: rgba(245, 158, 11, 0.12);
        }

        .leaderboard-rank {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .leaderboard-rank.rank-1 {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #000;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
        }

        .leaderboard-rank.rank-2 {
            background: linear-gradient(135deg, #a1a1aa, #71717a);
            color: #000;
        }

        .leaderboard-rank.rank-3 {
            background: linear-gradient(135deg, #fb923c, #ea580c);
            color: #fff;
        }

        .leaderboard-rank.rank-other {
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-tertiary);
        }

        .leaderboard-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }

        .leaderboard-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .leaderboard-info {
            flex: 1;
            min-width: 0;
        }

        .leaderboard-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .leaderboard-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .leaderboard-bar-fill {
            height: 100%;
            border-radius: var(--radius-full);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .leaderboard-value {
            font-size: 1rem;
            font-weight: 700;
            flex-shrink: 0;
            min-width: 50px;
            text-align: right;
        }

        /* Metrics Section */
        .metrics-section {
            margin-bottom: var(--spacing-xl);
        }

        .metrics-tabs {
            display: flex;
            gap: 6px;
            margin-bottom: var(--spacing-lg);
            background: rgba(255, 255, 255, 0.04);
            padding: 4px;
            border-radius: var(--radius-full);
        }

        .metric-tab {
            flex: 1;
            padding: 10px var(--spacing-md);
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--text-tertiary);
            border-radius: var(--radius-full);
            transition: all 0.2s ease;
            text-align: center;
        }

        .metric-tab.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        .metric-tab:active {
            transform: scale(0.96);
        }

        .metrics-leaderboard {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .metrics-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
        }

        .metrics-item.rank-1.floors {
            background: rgba(59, 130, 246, 0.08);
            border-color: rgba(59, 130, 246, 0.2);
        }

        .metrics-item.rank-1.distance {
            background: rgba(16, 185, 129, 0.08);
            border-color: rgba(16, 185, 129, 0.2);
        }

        .metrics-value {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            flex-shrink: 0;
            min-width: 60px;
        }

        .metrics-value-main {
            font-size: 1rem;
            font-weight: 700;
        }

        .metrics-value-sub {
            font-size: 0.625rem;
            color: var(--text-tertiary);
        }

        /* Activity Indicator */
        .activity-indicator {
            font-size: 0.625rem;
            color: var(--text-tertiary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .activity-indicator svg {
            width: 10px;
            height: 10px;
        }

        .activity-indicator.walking { color: var(--accent-emerald); }
        .activity-indicator.running { color: var(--accent-orange); }
        .activity-indicator.stationary { color: var(--text-muted); }
        .activity-indicator.automotive { color: var(--accent-cyan); }

        /* Family Pill States on Home */
        #familyPill.all-home {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }

        #familyPill.some-home {
            background: rgba(168, 85, 247, 0.08);
            border-color: rgba(168, 85, 247, 0.2);
        }

        /* Legacy support */
        .family-section-title { display: none; }
        .section-total { display: none; }
        .family-cards-scroll { display: none; }
        .family-home-summary { display: none; }

        /* ============================================
           CALENDAR VIEW - Mobile Optimized
           ============================================ */

        /* Calendar Header */
        .cal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-xl);
            background: var(--bg-primary);
        }

        .cal-header-main {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .cal-nav-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .cal-nav-btn:active {
            background: var(--bg-secondary);
            transform: scale(0.95);
        }

        .cal-nav-btn svg {
            width: 20px;
            height: 20px;
        }

        .cal-month-title {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .cal-month-title:active {
            background: var(--bg-secondary);
        }

        .cal-dropdown-icon {
            width: 16px;
            height: 16px;
            color: var(--text-tertiary);
            transition: transform 0.2s ease;
        }

        .cal-dropdown-icon.open {
            transform: rotate(180deg);
        }

        .cal-today-btn {
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.8125rem;
            font-weight: 600;
            color: var(--accent-purple);
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: var(--radius-full);
            transition: var(--transition-fast);
        }

        .cal-today-btn:active {
            transform: scale(0.95);
            background: rgba(168, 85, 247, 0.2);
        }

        /* Mini Calendar */
        .mini-calendar-container {
            overflow: hidden;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--glass-border);
            transition: max-height 0.3s ease;
        }

        .mini-calendar-container.collapsed {
            max-height: 0;
            border-bottom: none;
        }

        .mini-calendar-container.expanded {
            max-height: 300px;
        }

        .mini-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            padding: var(--spacing-md) var(--spacing-lg);
        }

        .mini-cal-header {
            font-size: 0.625rem;
            font-weight: 600;
            color: var(--text-muted);
            text-align: center;
            padding: var(--spacing-xs);
            text-transform: uppercase;
        }

        .mini-cal-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--text-secondary);
            border-radius: var(--radius-md);
            position: relative;
            transition: var(--transition-fast);
        }

        .mini-cal-day.other-month {
            color: var(--text-muted);
        }

        .mini-cal-day.today {
            background: var(--accent-purple);
            color: white;
            font-weight: 700;
        }

        .mini-cal-day.selected {
            background: rgba(168, 85, 247, 0.2);
            border: 1px solid var(--accent-purple);
        }

        .mini-cal-day.has-events::after {
            content: '';
            position: absolute;
            bottom: 4px;
            width: 4px;
            height: 4px;
            background: var(--accent-amber);
            border-radius: 50%;
        }

        .mini-cal-day:active {
            background: var(--bg-tertiary);
        }

        /* Week Strip */
        .week-strip-wrapper {
            display: flex;
            align-items: center;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--glass-border);
            padding: var(--spacing-xs) 0;
        }

        .week-nav-btn {
            flex: 0 0 auto;
            width: 32px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 0;
        }

        .week-nav-btn svg {
            width: 16px;
            height: 16px;
        }

        .week-nav-btn:active {
            color: var(--accent-purple);
        }

        .week-strip {
            flex: 1;
            overflow: hidden;
        }

        .week-strip-scroll {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            padding: 0 var(--spacing-xs);
            gap: 2px;
            scroll-behavior: smooth;
        }

        .week-strip-scroll::-webkit-scrollbar {
            display: none;
        }

        .week-day {
            flex: 0 0 auto;
            width: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px 4px;
            border-radius: var(--radius-md);
            scroll-snap-align: center;
            position: relative;
            transition: var(--transition-fast);
            position: relative;
        }

        .week-day-name {
            font-size: 0.625rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .week-day-num {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            line-height: 1;
        }

        .week-day.today {
            background: var(--accent-purple);
        }

        .week-day.today .week-day-name,
        .week-day.today .week-day-num {
            color: white;
        }

        .week-day.selected:not(.today) {
            background: rgba(168, 85, 247, 0.15);
        }

        .week-day.selected .week-day-num {
            color: var(--accent-purple);
        }

        .week-day.other-month .week-day-num {
            color: var(--text-muted);
            opacity: 0.5;
        }

        .week-day-dots {
            font-size: 8px;
            color: var(--accent-amber);
            line-height: 1;
            letter-spacing: -1px;
            margin-top: 2px;
            height: 8px;
        }

        .week-day.today .week-day-dots {
            color: rgba(255, 255, 255, 0.8);
        }

        .week-day:active {
            transform: scale(0.95);
        }

        /* View Mode Toggle */
        .cal-view-toggle {
            display: flex;
            justify-content: center;
            gap: 4px;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-secondary);
        }

        .cal-view-btn {
            flex: 1;
            max-width: 80px;
            padding: 8px 12px;
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            color: var(--text-muted);
            font-size: 0.75rem;
            font-weight: 500;
            transition: var(--transition-fast);
        }

        .cal-view-btn.active {
            background: var(--accent-purple);
            border-color: var(--accent-purple);
            color: white;
        }

        .cal-view-btn:active {
            transform: scale(0.95);
        }

        /* Calendar Content */
        .cal-content {
            padding-top: var(--spacing-sm);
            padding-bottom: calc(var(--safe-bottom) + 140px);
        }

        /* Calendar Stats */
        .cal-stats {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .cal-stat {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
        }

        .cal-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent-purple);
        }

        .cal-stat-label {
            font-size: 0.625rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Agenda Container */
        .agenda-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .agenda-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: calc(var(--spacing-xl) * 2);
            gap: var(--spacing-md);
            color: var(--text-tertiary);
        }

        .spinner {
            width: 24px;
            height: 24px;
            border: 2px solid var(--bg-tertiary);
            border-top-color: var(--accent-purple);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Agenda Day Group */
        .agenda-day {
            display: flex;
            flex-direction: column;
        }

        .agenda-day-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-sm) 0;
            margin-bottom: var(--spacing-sm);
            position: sticky;
            top: 0;
            background: var(--bg-primary);
            z-index: 5;
            border-bottom: 1px solid var(--glass-border);
        }

        .agenda-day-info {
            display: flex;
            align-items: baseline;
            gap: var(--spacing-sm);
        }

        .agenda-day-name {
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .agenda-day.today .agenda-day-name {
            color: var(--accent-purple);
        }

        .agenda-day-date-str {
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        .agenda-day-label {
            font-size: 0.6875rem;
            font-weight: 600;
            color: var(--accent-purple);
            background: rgba(168, 85, 247, 0.15);
            padding: 4px 10px;
            border-radius: var(--radius-full);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .agenda-day.selected:not(.today) .agenda-day-name {
            color: var(--accent-purple);
        }

        /* Agenda Events */
        .agenda-events {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .agenda-event {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            border-left: 3px solid var(--event-color, var(--accent-purple));
            transition: var(--transition-fast);
        }

        .agenda-event:active {
            transform: scale(0.98);
            background: var(--glass-hover);
        }

        .agenda-event-time {
            flex-shrink: 0;
            min-width: 50px;
        }

        .agenda-event-time-start {
            font-size: 0.8125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .agenda-event-time-end {
            font-size: 0.6875rem;
            color: var(--text-tertiary);
        }

        .agenda-event-time-allday {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--accent-purple);
        }

        .agenda-event-content {
            flex: 1;
            min-width: 0;
        }

        .agenda-event-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .agenda-event-location {
            font-size: 0.6875rem;
            color: var(--text-tertiary);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .agenda-event-location svg {
            width: 10px;
            height: 10px;
            flex-shrink: 0;
        }

        .agenda-event-assignee {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        /* Empty State */
        .agenda-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: calc(var(--spacing-xl) * 2);
            text-align: center;
        }

        .agenda-empty svg {
            width: 48px;
            height: 48px;
            color: var(--text-muted);
            margin-bottom: var(--spacing-md);
            opacity: 0.5;
        }

        .agenda-empty-text {
            font-size: 0.875rem;
            color: var(--text-tertiary);
            margin-bottom: var(--spacing-xs);
        }

        .agenda-empty-sub {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Floating Action Button */
        .cal-fab {
            position: fixed;
            bottom: calc(var(--safe-bottom) + 80px);
            right: var(--spacing-xl);
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), #7c3aed);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(168, 85, 247, 0.4);
            transition: var(--transition-fast);
            z-index: 50;
        }

        .cal-fab svg {
            width: 24px;
            height: 24px;
        }

        .cal-fab:active {
            transform: scale(0.95);
        }

        /* Calendar Modals */
        .cal-modal {
            position: fixed;
            inset: 0;
            z-index: 200;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .cal-modal-sheet {
            position: relative;
            width: 100%;
            max-height: 80vh;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            overflow: hidden;
            transform: translateY(0);
            animation: slideUp 0.3s ease-out;
            z-index: 201;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .cal-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-lg) var(--spacing-xl);
            border-bottom: 1px solid var(--glass-border);
        }

        .cal-modal-header h3 {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .cal-modal-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            border-radius: var(--radius-md);
        }

        .cal-modal-close svg {
            width: 20px;
            height: 20px;
        }

        .cal-modal-body {
            padding: var(--spacing-xl);
            padding-bottom: calc(var(--spacing-xl) + var(--safe-bottom));
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        /* Event Detail Modal */
        .cal-event-detail {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            padding: var(--spacing-sm) 0;
        }

        .cal-event-detail svg {
            width: 20px;
            height: 20px;
            color: var(--text-tertiary);
            flex-shrink: 0;
            margin-top: 2px;
        }

        .cal-event-detail span {
            font-size: 0.9375rem;
            color: var(--text-secondary);
        }

        .cal-event-assignee {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        /* Quick Add Modal */
        .cal-add-sheet {
            max-height: 85vh;
        }

        .cal-save-btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: 0.875rem;
            font-weight: 600;
            color: white;
            background: var(--accent-purple);
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
        }

        .cal-save-btn:active {
            transform: scale(0.95);
        }

        .cal-input {
            width: 100%;
            padding: var(--spacing-md);
            font-size: 0.9375rem;
            color: var(--text-primary);
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            outline: none;
            transition: border-color 0.2s ease;
        }

        .cal-input:focus {
            border-color: var(--accent-purple);
        }

        .cal-input::placeholder {
            color: var(--text-muted);
        }

        .cal-textarea {
            min-height: 80px;
            resize: none;
        }

        .cal-input-row {
            display: flex;
            gap: var(--spacing-md);
            align-items: center;
        }

        .cal-input-row .cal-input {
            flex: 1;
        }

        .cal-checkbox {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .cal-checkbox input {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-purple);
        }

        .cal-time-row {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
        }

        .cal-time-row .cal-input {
            flex: 1;
        }

        .cal-time-sep {
            font-size: 0.8125rem;
            color: var(--text-tertiary);
        }

        .cal-time-row.hidden {
            display: none;
        }

        /* Bottom Nav Compact (5 items) */
        .bottom-nav {
            grid-template-columns: repeat(5, 1fr);
        }

        .nav-item {
            padding: var(--spacing-sm) 2px;
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
        }

        .nav-item span {
            font-size: 0.5625rem;
        }

        /* ============================================
           2025 DESIGN SYSTEM UPGRADES
           Enhanced Glass Morphism & Microinteractions
           ============================================ */

        /* Spring Animation Curves */
        @keyframes spring-in {
            0% { transform: scale(0.9) translateY(20px); opacity: 0; }
            60% { transform: scale(1.02) translateY(-5px); }
            100% { transform: scale(1) translateY(0); opacity: 1; }
        }

        @keyframes glow-pulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.1); }
        }

        @keyframes slide-up-spring {
            0% { transform: translateY(100%); }
            60% { transform: translateY(-5%); }
            100% { transform: translateY(0); }
        }

        /* Enhanced Status Pills 2025 */
        .status-pill {
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .status-pill::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(
                circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
                rgba(255, 255, 255, 0.1) 0%,
                transparent 50%
            );
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .status-pill:hover::before,
        .status-pill:active::before {
            opacity: 1;
        }

        .status-pill.active {
            animation: glow-pulse 3s ease-in-out infinite;
        }

        /* Enhanced Bottom Nav 2025 */
        .bottom-nav {
            background: linear-gradient(
                to top,
                rgba(10, 10, 15, 0.98) 0%,
                rgba(10, 10, 15, 0.95) 60%,
                rgba(10, 10, 15, 0.8) 100%
            );
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
        }

        .nav-item {
            position: relative;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) scaleX(0);
            width: 24px;
            height: 3px;
            background: var(--accent-cyan);
            border-radius: 0 0 3px 3px;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .nav-item.active::before {
            transform: translateX(-50%) scaleX(1);
            box-shadow: 0 0 12px var(--accent-cyan);
        }

        .nav-item:active {
            transform: scale(0.9);
        }

        .nav-item.active svg {
            filter: drop-shadow(0 0 8px var(--accent-cyan));
        }

        /* ============================================
           AI SURVEILLANCE VIEW - Mobile Optimized
           ============================================ */

        .surv-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) 0;
        }

        .surv-title-wrap {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .surv-icon-ring {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, rgba(244, 63, 94, 0.2), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(244, 63, 94, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .surv-icon-ring::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: inherit;
            background: conic-gradient(from 0deg, transparent, rgba(244, 63, 94, 0.5), transparent);
            animation: spin 3s linear infinite;
            z-index: -1;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .surv-icon-ring svg {
            width: 22px;
            height: 22px;
            color: #f43f5e;
        }

        .surv-title-text h2 {
            font-size: 1.125rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            color: var(--text-primary);
        }

        .surv-title-text span {
            font-size: 0.6875rem;
            color: rgba(244, 63, 94, 0.7);
            font-family: monospace;
        }

        /* Surveillance Stats Bar */
        .surv-stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
        }

        .surv-stat {
            text-align: center;
        }

        .surv-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            display: block;
        }

        .surv-stat-label {
            font-size: 0.625rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Surveillance Filter Pills */
        .surv-filters {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
            overflow-x: auto;
            padding-bottom: var(--spacing-xs);
            -webkit-overflow-scrolling: touch;
        }

        .surv-filters::-webkit-scrollbar {
            display: none;
        }

        .surv-filter-btn {
            flex-shrink: 0;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .surv-filter-btn.active {
            background: rgba(244, 63, 94, 0.15);
            border-color: rgba(244, 63, 94, 0.4);
            color: #f43f5e;
        }

        .surv-filter-btn svg {
            width: 14px;
            height: 14px;
        }

        /* Event Cards */
        .surv-events-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .surv-event-card {
            display: flex;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .surv-event-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--event-color, var(--accent-blue));
        }

        .surv-event-card.threat::before {
            background: var(--accent-red);
        }

        .surv-event-card:active {
            transform: scale(0.98);
            background: var(--glass-hover);
        }

        .surv-event-thumb {
            width: 80px;
            height: 60px;
            border-radius: var(--radius-sm);
            overflow: hidden;
            flex-shrink: 0;
            position: relative;
            background: var(--bg-tertiary);
        }

        .surv-event-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .surv-event-thumb .play-overlay {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.2s;
        }

        .surv-event-card:hover .play-overlay,
        .surv-event-card:active .play-overlay {
            opacity: 1;
        }

        .play-overlay svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        .surv-event-info {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .surv-event-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
        }

        .surv-event-label {
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .surv-event-label.person {
            background: rgba(244, 63, 94, 0.2);
            color: #f43f5e;
        }

        .surv-event-label.car {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .surv-event-label.dog,
        .surv-event-label.cat {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .surv-event-confidence {
            font-size: 0.6875rem;
            color: var(--text-tertiary);
            font-family: monospace;
        }

        .surv-event-camera {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .surv-event-time {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .surv-event-ai {
            margin-top: var(--spacing-xs);
            padding: var(--spacing-sm);
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .surv-event-ai.threat {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }

        /* Event Detail Modal */
        .surv-detail-modal {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }

        .surv-detail-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-lg);
            padding-top: calc(var(--spacing-lg) + var(--safe-top));
        }

        .surv-detail-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .surv-detail-close svg {
            width: 20px;
            height: 20px;
            color: var(--text-secondary);
        }

        .surv-detail-media {
            position: relative;
            aspect-ratio: 16/9;
            background: var(--bg-tertiary);
            margin: 0 var(--spacing-lg);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .surv-detail-media img,
        .surv-detail-media video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .surv-detail-content {
            flex: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
        }

        .surv-detail-actions {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg);
            padding-bottom: calc(var(--spacing-lg) + var(--safe-bottom));
            background: var(--bg-secondary);
        }

        .surv-detail-btn {
            flex: 1;
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            transition: all 0.2s;
        }

        .surv-detail-btn.primary {
            background: linear-gradient(135deg, #f43f5e, #ef4444);
            color: white;
        }

        .surv-detail-btn.secondary {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
        }

        .surv-detail-btn:active {
            transform: scale(0.95);
        }

        .surv-detail-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Alexa Mobile Buttons */
        .alexa-mobile-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 16px 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 80px;
        }

        .alexa-mobile-btn:active {
            transform: scale(0.95);
            opacity: 0.8;
        }

        .alexa-mobile-btn span {
            font-size: 0.75rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            margin-top: 8px;
        }

        /* Empty State */
        .surv-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-2xl);
            text-align: center;
        }

        .surv-empty svg {
            width: 64px;
            height: 64px;
            color: var(--text-muted);
            margin-bottom: var(--spacing-lg);
        }

        .surv-empty h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-sm);
        }

        .surv-empty p {
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        /* ============================================
           GUEST PASS VIEW - Mobile Optimized
           ============================================ */

        .guest-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md) 0;
        }

        .guest-icon-wrap {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, #f59e0b, #f97316);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--glow-amber);
        }

        .guest-icon-wrap svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        .guest-title h2 {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .guest-title span {
            font-size: 0.75rem;
            color: var(--accent-amber);
        }

        /* Quick Duration Presets */
        .guest-presets {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xl);
        }

        .guest-preset {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            transition: all 0.2s;
        }

        .guest-preset.active {
            background: rgba(245, 158, 11, 0.15);
            border-color: rgba(245, 158, 11, 0.4);
        }

        .guest-preset:active {
            transform: scale(0.95);
        }

        .guest-preset svg {
            width: 20px;
            height: 20px;
            color: var(--accent-amber);
        }

        .guest-preset span {
            font-size: 0.6875rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .guest-preset.active span {
            color: var(--accent-amber);
        }

        /* Create Pass Form */
        .guest-form {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .guest-input {
            width: 100%;
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.9375rem;
            margin-bottom: var(--spacing-md);
            transition: border-color 0.2s;
        }

        .guest-input:focus {
            border-color: var(--accent-amber);
            outline: none;
        }

        .guest-input::placeholder {
            color: var(--text-muted);
        }

        .guest-permissions {
            display: flex;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .guest-perm-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .guest-perm-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--accent-amber);
        }

        .guest-perm-item label {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .guest-perm-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .guest-perm-icon.gate {
            background: rgba(168, 85, 247, 0.15);
            color: var(--accent-purple);
        }

        .guest-perm-icon.garage {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
        }

        .guest-perm-icon svg {
            width: 16px;
            height: 16px;
        }

        .guest-generate-btn {
            width: 100%;
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, #f59e0b, #f97316);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            box-shadow: var(--glow-amber);
            transition: all 0.2s;
        }

        .guest-generate-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }

        .guest-generate-btn svg {
            width: 22px;
            height: 22px;
        }

        /* Active Passes List */
        .guest-passes-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-md);
        }

        .guest-passes-header h3 {
            font-size: 1rem;
            font-weight: 600;
        }

        .guest-passes-count {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .guest-passes-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .guest-pass-card {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            position: relative;
        }

        .guest-pass-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            font-weight: 600;
            color: white;
            flex-shrink: 0;
        }

        .guest-pass-info {
            flex: 1;
            min-width: 0;
        }

        .guest-pass-name {
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .guest-pass-meta {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .guest-pass-perms {
            display: flex;
            gap: 4px;
        }

        .guest-pass-perms svg {
            width: 14px;
            height: 14px;
        }

        .guest-pass-expires {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .guest-pass-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        .guest-pass-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .guest-pass-btn:active {
            transform: scale(0.9);
        }

        .guest-pass-btn svg {
            width: 16px;
            height: 16px;
            color: var(--text-secondary);
        }

        .guest-pass-btn.share {
            background: rgba(16, 185, 129, 0.15);
            border-color: rgba(16, 185, 129, 0.3);
        }

        .guest-pass-btn.share svg {
            color: var(--accent-emerald);
        }

        .guest-pass-btn.revoke {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
        }

        .guest-pass-btn.revoke svg {
            color: var(--accent-red);
        }

        /* Generated Pass Modal */
        .guest-modal {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .guest-modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }

        .guest-modal-sheet {
            position: relative;
            width: 100%;
            max-height: 85vh;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            padding: var(--spacing-xl);
            padding-bottom: calc(var(--spacing-xl) + var(--safe-bottom));
            animation: slide-up-spring 0.4s ease-out;
        }

        .guest-modal-handle {
            width: 40px;
            height: 4px;
            background: var(--glass-border);
            border-radius: 2px;
            margin: 0 auto var(--spacing-xl);
        }

        .guest-modal-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .guest-modal-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, #f59e0b, #f97316);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .guest-modal-icon svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        .guest-modal-title h3 {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .guest-modal-title span {
            font-size: 0.8125rem;
            color: var(--text-tertiary);
        }

        .guest-modal-url {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .guest-modal-url input {
            flex: 1;
            padding: var(--spacing-md);
            background: var(--bg-primary);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.8125rem;
            font-family: monospace;
        }

        .guest-modal-copy {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .guest-modal-copy:active {
            transform: scale(0.95);
        }

        .guest-modal-copy svg {
            width: 18px;
            height: 18px;
        }

        .guest-modal-share {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-md);
        }

        .guest-share-btn {
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            font-size: 0.9375rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .guest-share-btn:active {
            transform: scale(0.95);
        }

        .guest-share-btn.whatsapp {
            background: rgba(37, 211, 102, 0.15);
            border: 1px solid rgba(37, 211, 102, 0.3);
            color: #25d366;
        }

        .guest-share-btn.share {
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: var(--accent-blue);
        }

        .guest-share-btn svg {
            width: 20px;
            height: 20px;
        }

        .guest-modal-validity {
            margin-top: var(--spacing-lg);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--glass-border);
            text-align: center;
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        /* Empty passes state */
        .guest-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: var(--spacing-2xl);
            text-align: center;
        }

        .guest-empty svg {
            width: 56px;
            height: 56px;
            color: var(--text-muted);
            margin-bottom: var(--spacing-md);
        }

        .guest-empty h3 {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xs);
        }

        .guest-empty p {
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        /* ============================================
           MORE MENU OVERLAY
           ============================================ */

        .more-menu-overlay {
            position: fixed;
            inset: 0;
            z-index: 90;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .more-menu-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
        }

        .more-menu-sheet {
            position: relative;
            width: 100%;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            padding: var(--spacing-lg);
            padding-bottom: calc(100px + var(--safe-bottom));
            animation: slide-up-spring 0.3s ease-out;
        }

        .more-menu-handle {
            width: 40px;
            height: 4px;
            background: var(--glass-border);
            border-radius: 2px;
            margin: 0 auto var(--spacing-lg);
        }

        .more-menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-md);
        }

        .more-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            transition: all 0.2s;
        }

        .more-menu-item:active {
            transform: scale(0.95);
            background: var(--glass-hover);
        }

        .more-menu-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .more-menu-icon svg {
            width: 22px;
            height: 22px;
        }

        .more-menu-icon.ai {
            background: rgba(244, 63, 94, 0.15);
            color: #f43f5e;
        }

        .more-menu-icon.guest {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
        }

        .more-menu-icon.family {
            background: rgba(236, 72, 153, 0.15);
            color: #ec4899;
        }

        .more-menu-icon.energy {
            background: rgba(34, 211, 238, 0.15);
            color: #22d3ee;
        }

        .more-menu-icon.alexa {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }

        .more-menu-icon.settings {
            background: rgba(148, 163, 184, 0.15);
            color: #94a3b8;
        }

        .more-menu-item span {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* Badge for new features */
        .more-menu-item .badge {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-red);
        }

        /* ============================================
           ACTION OVERLAY - Gate/Garage Feedback
           ============================================ */

        .action-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: all;
        }

        .action-overlay.visible {
            opacity: 1;
        }

        .action-overlay-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
            padding: 48px 64px;
            background: var(--bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: var(--radius-2xl);
            box-shadow:
                var(--neu-raised-lg),
                0 20px 60px rgba(0, 0, 0, 0.5);
            animation: overlayPulseNeu 2.5s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        .action-overlay-content::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(145deg, rgba(255,255,255,0.04) 0%, transparent 50%);
            pointer-events: none;
        }

        @keyframes overlayPulseNeu {
            0%, 100% { transform: scale(1); box-shadow: var(--neu-raised-lg), 0 20px 60px rgba(0, 0, 0, 0.5); }
            50% { transform: scale(1.02); box-shadow: var(--neu-raised-lg), 0 25px 70px rgba(0, 0, 0, 0.4); }
        }

        .action-overlay-icon {
            width: 88px;
            height: 88px;
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: var(--neu-raised-md);
        }

        .action-overlay-icon.gate {
            background: linear-gradient(145deg, rgba(34, 211, 238, 0.25) 0%, rgba(34, 211, 238, 0.1) 100%);
            border: 1px solid rgba(34, 211, 238, 0.4);
            box-shadow:
                var(--neu-raised-md),
                0 0 40px rgba(34, 211, 238, 0.3),
                0 0 80px rgba(34, 211, 238, 0.15);
        }

        .action-overlay-icon.garage {
            background: linear-gradient(145deg, rgba(251, 191, 36, 0.25) 0%, rgba(251, 191, 36, 0.1) 100%);
            border: 1px solid rgba(251, 191, 36, 0.4);
            box-shadow:
                var(--neu-raised-md),
                0 0 40px rgba(251, 191, 36, 0.3),
                0 0 80px rgba(251, 191, 36, 0.15);
        }

        .action-overlay-icon svg {
            width: 44px;
            height: 44px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
        }

        .action-overlay-icon.gate svg {
            color: var(--accent-cyan);
            filter: drop-shadow(0 0 12px rgba(34, 211, 238, 0.6));
        }

        .action-overlay-icon.garage svg {
            color: var(--accent-amber);
            filter: drop-shadow(0 0 12px rgba(251, 191, 36, 0.6));
        }

        .action-overlay-text {
            font-size: 1.75rem;
            font-weight: 800;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            text-align: center;
            text-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        .action-overlay-subtext {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-tertiary);
            text-align: center;
        }

        .action-overlay-spinner {
            width: 28px;
            height: 28px;
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-top-color: white;
            border-radius: 50%;
            animation: spinOverlay 0.8s linear infinite;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .action-overlay-spinner.loading {
            width: 52px;
            height: 52px;
            border-width: 4px;
        }

        @keyframes spinOverlay {
            to { transform: rotate(360deg); }
        }

        .action-overlay.not-ready .action-overlay-content {
            background: linear-gradient(145deg, rgba(248, 113, 113, 0.1) 0%, var(--bg-secondary) 100%);
            border-color: rgba(248, 113, 113, 0.25);
            box-shadow:
                var(--neu-raised-lg),
                0 0 30px rgba(248, 113, 113, 0.15);
        }

        /* ============================================
           PREMIUM BUTTON FEEDBACK SYSTEM
           2025 Neumorphism + 3D Transform Trends
           ============================================ */

        /* Base interactive element - applies to all pressable items */
        .pressable {
            position: relative;
            transform-style: preserve-3d;
            transform: perspective(1000px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s cubic-bezier(0.2, 0, 0.2, 1),
                filter 0.15s ease;
            will-change: transform, box-shadow;
            -webkit-tap-highlight-color: transparent;
            cursor: pointer;
        }

        /* Neumorphic raised state (default) */
        .pressable::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
            background: radial-gradient(
                circle at 30% 30%,
                rgba(255, 255, 255, 0.15) 0%,
                transparent 60%
            );
        }

        /* Active/pressed state - 3D depth effect */
        .pressable:active,
        .pressable.pressing {
            transform: perspective(1000px) translateZ(-8px) scale(0.97);
            filter: brightness(0.92);
        }

        .pressable:active::before,
        .pressable.pressing::before {
            opacity: 0;
        }

        /* Press ripple effect */
        .press-ripple {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(
                circle,
                rgba(255, 255, 255, 0.4) 0%,
                rgba(255, 255, 255, 0.1) 40%,
                transparent 70%
            );
            transform: scale(0);
            animation: rippleExpand 0.5s cubic-bezier(0.2, 0, 0.2, 1) forwards;
            pointer-events: none;
        }

        @keyframes rippleExpand {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2.5);
                opacity: 0;
            }
        }

        /* ============================================
           BUTTON TYPE VARIANTS
           ============================================ */

        /* Navigation items - Soft press with glow */
        .nav-item {
            transform-style: preserve-3d;
            transform: perspective(800px) translateZ(0);
            transition:
                transform 0.18s cubic-bezier(0.2, 0, 0.2, 1),
                color 0.2s ease,
                background 0.2s ease;
        }

        .nav-item:active {
            transform: perspective(800px) translateZ(-4px) scale(0.94);
        }

        .nav-item:active svg {
            transform: scale(0.9);
            transition: transform 0.12s cubic-bezier(0.2, 0, 0.2, 1);
        }

        /* Status pills - Tactile press */
        .status-pill {
            transform-style: preserve-3d;
            transform: perspective(600px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s ease,
                background 0.2s ease;
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.15),
                0 1px 3px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .status-pill:active {
            transform: perspective(600px) translateZ(-6px) scale(0.96);
            box-shadow:
                0 1px 4px rgba(0, 0, 0, 0.2),
                inset 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* Room cards - Deep press with surface shift */
        .room-card {
            transform-style: preserve-3d;
            transform: perspective(1000px) translateZ(0) rotateX(0deg);
            transition:
                transform 0.2s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.25s cubic-bezier(0.2, 0, 0.2, 1),
                filter 0.2s ease;
            box-shadow:
                0 8px 24px rgba(0, 0, 0, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .room-card:active {
            transform: perspective(1000px) translateZ(-12px) rotateX(2deg) scale(0.97);
            box-shadow:
                0 2px 8px rgba(0, 0, 0, 0.25),
                inset 0 3px 12px rgba(0, 0, 0, 0.2);
            filter: brightness(0.95);
        }

        .room-card:active .room-icon {
            transform: scale(0.92) translateY(2px);
            transition: transform 0.15s cubic-bezier(0.2, 0, 0.2, 1);
        }

        /* Camera cards - Cinematic press */
        .camera-card {
            transform-style: preserve-3d;
            transform: perspective(1200px) translateZ(0);
            transition:
                transform 0.2s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.25s ease,
                filter 0.2s ease;
            overflow: hidden;
        }

        .camera-card:active {
            transform: perspective(1200px) translateZ(-15px) scale(0.98);
            filter: brightness(0.9) saturate(1.1);
        }

        .camera-card:active .camera-overlay {
            background: linear-gradient(to top,
                rgba(0, 0, 0, 0.95) 0%,
                rgba(0, 0, 0, 0.4) 50%,
                transparent 100%);
        }

        .camera-card:active img {
            transform: scale(1.02);
            transition: transform 0.3s cubic-bezier(0.2, 0, 0.2, 1);
        }

        /* Quick action buttons (Gate/Garage) - Heavy tactile */
        .quick-action-btn {
            transform-style: preserve-3d;
            transform: perspective(800px) translateZ(0);
            transition:
                transform 0.12s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.18s ease,
                filter 0.12s ease;
            box-shadow:
                0 6px 20px rgba(0, 0, 0, 0.25),
                0 2px 6px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .quick-action-btn:active {
            transform: perspective(800px) translateZ(-10px) scale(0.95);
            box-shadow:
                0 1px 4px rgba(0, 0, 0, 0.3),
                inset 0 4px 16px rgba(0, 0, 0, 0.25);
            filter: brightness(0.88);
        }

        .quick-action-btn:active .icon-wrapper {
            transform: scale(0.88) translateY(3px);
            transition: transform 0.1s cubic-bezier(0.2, 0, 0.2, 1);
        }

        /* Alarm buttons - Urgent tactile feedback */
        .alarm-btn {
            transform-style: preserve-3d;
            transform: perspective(600px) translateZ(0);
            transition:
                transform 0.1s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.15s ease,
                filter 0.1s ease;
            box-shadow:
                0 4px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .alarm-btn:active {
            transform: perspective(600px) translateZ(-8px) scale(0.94);
            box-shadow:
                0 1px 4px rgba(0, 0, 0, 0.25),
                inset 0 3px 12px rgba(0, 0, 0, 0.3);
            filter: brightness(0.85);
        }

        .alarm-btn.stay:active { box-shadow: inset 0 3px 12px rgba(251, 191, 36, 0.3); }
        .alarm-btn.away:active { box-shadow: inset 0 3px 12px rgba(239, 68, 68, 0.3); }
        .alarm-btn.outside:active { box-shadow: inset 0 3px 12px rgba(59, 130, 246, 0.3); }
        .alarm-btn.disarm:active { box-shadow: inset 0 3px 12px rgba(34, 197, 94, 0.3); }

        /* Light toggle buttons - Satisfying click */
        .light-btn {
            transform-style: preserve-3d;
            transform: perspective(500px) translateZ(0);
            transition:
                transform 0.12s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.18s ease,
                background 0.2s ease;
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .light-btn:active {
            transform: perspective(500px) translateZ(-6px) scale(0.95);
            box-shadow:
                0 1px 3px rgba(0, 0, 0, 0.2),
                inset 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .light-btn:active .light-icon {
            transform: scale(0.9);
            transition: transform 0.1s cubic-bezier(0.2, 0, 0.2, 1);
        }

        /* Master buttons (All On/Off) - Commanding press */
        .master-btn {
            transform-style: preserve-3d;
            transform: perspective(600px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s ease,
                filter 0.15s ease;
            box-shadow:
                0 6px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .master-btn:active {
            transform: perspective(600px) translateZ(-10px) scale(0.96);
            box-shadow:
                0 2px 6px rgba(0, 0, 0, 0.25),
                inset 0 3px 10px rgba(0, 0, 0, 0.2);
            filter: brightness(0.9);
        }

        /* Floor toggle buttons - Tab switch feel */
        .floor-btn {
            transform-style: preserve-3d;
            transform: perspective(400px) translateZ(0);
            transition:
                transform 0.12s cubic-bezier(0.2, 0, 0.2, 1),
                background 0.2s ease,
                color 0.2s ease;
        }

        .floor-btn:active {
            transform: perspective(400px) translateZ(-4px) scale(0.96);
        }

        /* Modal close button - Quick dismiss */
        .modal-close {
            transform-style: preserve-3d;
            transform: perspective(300px) translateZ(0);
            transition:
                transform 0.1s cubic-bezier(0.2, 0, 0.2, 1),
                background 0.15s ease;
        }

        .modal-close:active {
            transform: perspective(300px) translateZ(-4px) scale(0.88);
            background: var(--bg-elevated);
        }

        /* Calendar & filter buttons - Chip press */
        .cal-nav-btn,
        .cal-today-btn,
        .cal-view-btn,
        .metric-tab,
        .surv-filter-btn,
        .guest-preset {
            transform-style: preserve-3d;
            transform: perspective(400px) translateZ(0);
            transition:
                transform 0.12s cubic-bezier(0.2, 0, 0.2, 1),
                background 0.15s ease,
                box-shadow 0.15s ease;
        }

        .cal-nav-btn:active,
        .cal-today-btn:active,
        .cal-view-btn:active,
        .metric-tab:active,
        .surv-filter-btn:active,
        .guest-preset:active {
            transform: perspective(400px) translateZ(-5px) scale(0.94);
        }

        /* Energy stat cards - Info card press */
        .energy-stat,
        .energy-stat-compact {
            transform-style: preserve-3d;
            transform: perspective(600px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s ease;
        }

        .energy-stat:active,
        .energy-stat-compact:active {
            transform: perspective(600px) translateZ(-6px) scale(0.98);
        }

        /* More menu items - List item press */
        .more-menu-item {
            transform-style: preserve-3d;
            transform: perspective(400px) translateZ(0);
            transition:
                transform 0.12s cubic-bezier(0.2, 0, 0.2, 1),
                background 0.15s ease;
        }

        .more-menu-item:active {
            transform: perspective(400px) translateZ(-6px) scale(0.97);
            background: rgba(255, 255, 255, 0.08);
        }

        /* Connect button - Primary action */
        .connect-btn {
            transform-style: preserve-3d;
            transform: perspective(500px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s ease,
                filter 0.15s ease;
            box-shadow:
                0 8px 24px rgba(168, 85, 247, 0.3),
                0 2px 8px rgba(168, 85, 247, 0.2);
        }

        .connect-btn:active {
            transform: perspective(500px) translateZ(-8px) scale(0.97);
            box-shadow:
                0 2px 8px rgba(168, 85, 247, 0.4),
                inset 0 2px 8px rgba(0, 0, 0, 0.2);
            filter: brightness(0.92);
        }

        /* Zone items - Status indicator press */
        .zone-item {
            transform-style: preserve-3d;
            transform: perspective(400px) translateZ(0);
            transition:
                transform 0.15s cubic-bezier(0.2, 0, 0.2, 1),
                box-shadow 0.2s ease;
        }

        .zone-item:active {
            transform: perspective(400px) translateZ(-5px) scale(0.97);
        }

        /* ============================================
           VISUAL FEEDBACK ENHANCEMENTS
           ============================================ */

        /* Press highlight flash */
        .press-flash {
            animation: flashHighlight 0.3s ease-out;
        }

        @keyframes flashHighlight {
            0% {
                filter: brightness(1.3);
            }
            100% {
                filter: brightness(1);
            }
        }

        /* Success feedback pulse */
        .press-success {
            animation: successPulse 0.4s ease-out;
        }

        @keyframes successPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.6);
            }
            50% {
                box-shadow: 0 0 0 12px rgba(34, 197, 94, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
            }
        }

        /* Icon bounce on press release */
        .icon-bounce {
            animation: iconBounce 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes iconBounce {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.08); }
            100% { transform: scale(1); }
        }

        /* ============================================
           ACCESSIBILITY - Reduced Motion
           ============================================ */

        @media (prefers-reduced-motion: reduce) {
            .pressable,
            .nav-item,
            .status-pill,
            .room-card,
            .camera-card,
            .quick-action-btn,
            .alarm-btn,
            .light-btn,
            .master-btn,
            .floor-btn,
            .modal-close,
            .cal-nav-btn,
            .cal-today-btn,
            .cal-view-btn,
            .metric-tab,
            .surv-filter-btn,
            .guest-preset,
            .energy-stat,
            .energy-stat-compact,
            .more-menu-item,
            .connect-btn,
            .zone-item {
                transition: none !important;
                transform: none !important;
            }

            .pressable:active,
            .nav-item:active,
            .status-pill:active,
            .room-card:active,
            .camera-card:active,
            .quick-action-btn:active,
            .alarm-btn:active,
            .light-btn:active,
            .master-btn:active,
            .floor-btn:active,
            .modal-close:active,
            .cal-nav-btn:active,
            .cal-today-btn:active,
            .cal-view-btn:active,
            .metric-tab:active,
            .surv-filter-btn:active,
            .guest-preset:active,
            .energy-stat:active,
            .energy-stat-compact:active,
            .more-menu-item:active,
            .connect-btn:active,
            .zone-item:active {
                opacity: 0.7;
                transform: none !important;
            }

            .press-ripple,
            .press-flash,
            .press-success,
            .icon-bounce {
                animation: none !important;
            }
        }

        /* ============================================
           DELAYED EXIT OVERLAY - Premium Animations
           ============================================ */

        .delayed-exit-overlay {
            opacity: 0;
            animation: exitOverlayIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .delayed-exit-overlay[style*="display: none"] {
            animation: none;
        }

        @keyframes exitOverlayIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
                -webkit-backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(20px);
                -webkit-backdrop-filter: blur(20px);
            }
        }

        /* Mode selection buttons - elegant hover states */
        .delayed-exit-overlay button[data-action="selectExitMode"] {
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            transform: translateX(0);
            opacity: 1;
        }

        .delayed-exit-overlay button[data-action="selectExitMode"]:active {
            transform: scale(0.97);
            filter: brightness(1.1);
        }

        /* Staggered entrance animation for mode buttons */
        #exitModeSelection button[data-action="selectExitMode"]:nth-child(1) {
            animation: modeSlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) 0.1s both;
        }
        #exitModeSelection button[data-action="selectExitMode"]:nth-child(2) {
            animation: modeSlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) 0.15s both;
        }
        #exitModeSelection button[data-action="selectExitMode"]:nth-child(3) {
            animation: modeSlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
        }

        @keyframes modeSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Countdown ring - enhanced glow */
        #countdownContainer {
            position: relative;
        }

        #countdownContainer::before {
            content: '';
            position: absolute;
            inset: -20px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.15) 0%, transparent 70%);
            animation: countdownGlow 3s ease-in-out infinite;
        }

        @keyframes countdownGlow {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* Progress ring animated gradient rotation */
        #countdownProgressMobile {
            filter: drop-shadow(0 0 8px rgba(139, 92, 246, 0.5));
            transition: stroke-dashoffset 0.25s linear;
        }

        /* Countdown time display - pulse on urgent */
        .countdown-urgent {
            animation: urgentPulse 0.5s ease-in-out infinite;
        }

        @keyframes urgentPulse {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 0 20px rgba(248, 113, 113, 0.5);
            }
            50% {
                transform: scale(1.02);
                text-shadow: 0 0 40px rgba(248, 113, 113, 0.8);
            }
        }

        /* Success state overlay */
        .delayed-exit-overlay.exit-success {
            animation: successFlash 0.6s ease-out;
        }

        .delayed-exit-overlay.exit-success::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, rgba(16, 185, 129, 0.3) 0%, transparent 70%);
            animation: successRipple 1s ease-out forwards;
            pointer-events: none;
        }

        @keyframes successFlash {
            0% { background: rgba(0,0,0,0.9); }
            30% { background: rgba(16, 185, 129, 0.3); }
            100% { background: rgba(0,0,0,0.9); }
        }

        @keyframes successRipple {
            from {
                transform: scale(0.5);
                opacity: 1;
            }
            to {
                transform: scale(2);
                opacity: 0;
            }
        }

        /* Cancel button subtle glow */
        .delayed-exit-overlay button[data-action="cancelDelayedExit"],
        .delayed-exit-overlay button[data-action="hideDelayedExit"] {
            transition: all 0.2s ease;
        }

        .delayed-exit-overlay button[data-action="cancelDelayedExit"]:active,
        .delayed-exit-overlay button[data-action="hideDelayedExit"]:active {
            background: rgba(255,255,255,0.15);
            transform: scale(0.98);
        }

        /* ARM NOW button enhanced */
        .delayed-exit-overlay button[data-action="executeExitNow"] {
            position: relative;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .delayed-exit-overlay button[data-action="executeExitNow"]::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .delayed-exit-overlay button[data-action="executeExitNow"]:active {
            transform: scale(0.97);
            filter: brightness(1.1);
        }

        .delayed-exit-overlay button[data-action="executeExitNow"]:active::before {
            opacity: 1;
        }

        /* Countdown view entrance animation */
        #exitCountdownView {
            animation: countdownViewIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes countdownViewIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Target badge pulse */
        #exitTargetBadge {
            animation: badgePulse 4s ease-in-out infinite;
        }

        @keyframes badgePulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(139, 92, 246, 0);
            }
            50% {
                box-shadow: 0 0 0 8px rgba(139, 92, 246, 0.1);
            }
        }

        /* Particle effects during countdown */
        #countdownContainer::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(139, 92, 246, 0.8);
            border-radius: 50%;
            animation: orbitParticle 3s linear infinite;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        @keyframes orbitParticle {
            from {
                transform: rotate(0deg) translateX(110px) rotate(0deg);
                opacity: 0.5;
            }
            50% {
                opacity: 1;
            }
            to {
                transform: rotate(360deg) translateX(110px) rotate(-360deg);
                opacity: 0.5;
            }
        }
    </style>
</head>
<body>
    <!-- Ambient Background -->
    <div class="ambient-bg">
        <div class="ambient-orb purple"></div>
        <div class="ambient-orb blue"></div>
        <div class="ambient-orb cyan"></div>
    </div>

    <!-- Connection Modal - Token Only -->
    <div id="connectModal" class="connect-modal">
        <div class="connect-card">
            <div class="connect-logo">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
            </div>
            <h1 class="connect-title">Welcome Home</h1>
            <p class="connect-subtitle">Enter your access token to connect</p>
            <input type="password" id="haToken" class="connect-input" placeholder="Long-lived access token" autocomplete="current-password">
            <button data-action="connectHA" class="connect-btn">Connect</button>
            <p id="errorMsg" class="connect-error hidden"></p>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="mobile-app hidden">
        <!-- Home View -->
        <div id="view-home" class="view">
            <header class="mobile-header">
                <div class="status-bar">
                    <div>
                        <div class="time-display" id="timeDisplay">--:--</div>
                        <div class="date-display" id="dateDisplay">Loading...</div>
                    </div>
                    <div class="header-right">
                        <div class="weather-badge">
                            <svg class="weather-icon" fill="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="5"/>
                                <path stroke="currentColor" stroke-width="2" d="M12 2v2m0 16v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M2 12h2m16 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                            </svg>
                            <span id="weatherTemp">--</span>
                        </div>
                        <div class="connection-dot" id="connDot"></div>
                    </div>
                </div>
            </header>

            <main class="mobile-content">
                <!-- Status Pills -->
                <div class="status-pills">
                    <button id="lightsPill" class="status-pill lights" data-action="openAllLightsModal">
                        <svg class="icon text-amber" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                        <span class="value" id="lightsOnCount">0</span>
                        <span class="label">Lights</span>
                    </button>

                    <div class="status-pill power">
                        <svg class="icon text-emerald" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                        <span class="value" id="totalPower">0W</span>
                        <span class="label">Power</span>
                    </div>

                    <button id="securityPill" class="status-pill security" data-action="showView" data-param-view="security">
                        <svg class="icon text-emerald" id="securityPillIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                        <span class="value" id="securityPillStatus">Disarmed</span>
                    </button>

                    <button id="familyPill" class="status-pill" data-action="showView" data-param-view="family">
                        <svg class="icon text-purple" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <span class="value" id="peopleHome">--</span>
                        <span class="label">Home</span>
                    </button>
                </div>

                <!-- Rooms Section -->
                <div class="section-header">
                    <h2 class="section-title">Rooms</h2>
                    <div class="floor-toggle">
                        <button id="floorGround" class="floor-btn active" data-action="selectFloor" data-param-floor="ground">Ground</button>
                        <button id="floorUpper" class="floor-btn" data-action="selectFloor" data-param-floor="upper">Upper</button>
                    </div>
                </div>

                <div id="roomsGrid" class="rooms-grid">
                    <!-- Rooms populated by JS -->
                </div>
            </main>
        </div>

        <!-- Cameras View -->
        <div id="view-cameras" class="view hidden">
            <header class="mobile-header">
                <div class="section-header" style="margin: 0;">
                    <h2 class="section-title">Cameras</h2>
                    <button class="modal-close" data-action="showView" data-param-view="home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="mobile-content">
                <div class="cameras-stack">
                    <button class="camera-card" data-action="toggleGateWithFeedback">
                        <img id="cam-gate" src="" alt="Gate Camera">
                        <div class="camera-overlay">
                            <div class="live-badge">
                                <div class="live-dot"></div>
                                <span style="font-size: 0.6875rem; font-weight: 600;">LIVE</span>
                            </div>
                            <div>
                                <div class="camera-name">Gate</div>
                                <div class="camera-status" id="cameraGateStatus">Closed</div>
                                <div class="tap-hint">Tap to toggle gate</div>
                            </div>
                        </div>
                    </button>

                    <div class="camera-card-wrapper" style="position: relative;">
                        <button class="camera-card" data-action="toggleGarageWithFeedback">
                            <img id="cam-garage" src="" alt="Garage Camera">
                            <div class="camera-overlay">
                                <div class="live-badge">
                                    <div class="live-dot"></div>
                                    <span style="font-size: 0.6875rem; font-weight: 600;">LIVE</span>
                                </div>
                                <div>
                                    <div class="camera-name">Garage</div>
                                    <div class="camera-status" id="cameraGarageStatus">Closed</div>
                                    <div class="tap-hint">Tap to toggle garage</div>
                                </div>
                            </div>
                        </button>
                        <!-- DELIVERY MODE OVERLAY -->
                        <div id="deliveryModeOverlay" style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); z-index: 30;">
                            <!-- Initial State: Start Button -->
                            <button id="deliveryModeStartBtn" data-action="startDeliveryModeFromCamera"
                                style="display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: rgba(16, 185, 129, 0.9); color: white; font-weight: 600; font-size: 0.875rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); border: none;">
                                <svg style="width: 18px; height: 18px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
                                </svg>
                                <span>Delivery Mode</span>
                            </button>
                            <!-- Active State: Monitoring + Cancel -->
                            <div id="deliveryModeActive" class="hidden" style="display: none; align-items: center; gap: 8px;">
                                <div style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: rgba(59, 130, 246, 0.9); color: white; font-weight: 600; font-size: 0.875rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);">
                                    <div style="width: 8px; height: 8px; border-radius: 50%; background: white; animation: pulse 1.5s infinite;"></div>
                                    <span>AI Monitoring</span>
                                </div>
                                <button id="deliveryModeCancelBtn" data-action="cancelDeliveryMode"
                                    style="display: flex; align-items: center; gap: 4px; padding: 8px 12px; background: rgba(239, 68, 68, 0.9); color: white; font-weight: 600; font-size: 0.875rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3); border: none;">
                                    <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                    </svg>
                                    <span>Cancel</span>
                                </button>
                            </div>
                            <!-- Package Detected State -->
                            <div id="deliveryModeThankYou" class="hidden" style="display: none; align-items: center; gap: 6px; padding: 8px 12px; background: rgba(245, 158, 11, 0.9); color: white; font-weight: 600; font-size: 0.75rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                </svg>
                                <span>Package Received - Close Garage</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Security View -->
        <div id="view-security" class="view hidden">
            <header class="mobile-header">
                <div class="section-header" style="margin: 0;">
                    <h2 class="section-title">Security</h2>
                    <button class="modal-close" data-action="showView" data-param-view="home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="mobile-content">
                <div id="securityStatusCard" class="security-status-card">
                    <div style="display: flex; align-items: center; gap: 16px;">
                        <div id="securityStatusIcon" class="room-icon emerald">
                            <svg style="width: 24px; height: 24px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                            </svg>
                        </div>
                        <div>
                            <div id="securityStatusTitle" style="font-size: 1.125rem; font-weight: 600;">Disarmed</div>
                            <div id="securityStatusSub" style="font-size: 0.875rem; color: var(--text-tertiary);">All zones inactive</div>
                        </div>
                    </div>
                </div>

                <div class="alarm-buttons">
                    <button class="alarm-btn stay" data-action="armAlarm" data-param-mode="arm_home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        <span class="text-amber">Stay</span>
                    </button>
                    <button class="alarm-btn away" data-action="armAlarm" data-param-mode="arm_away">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <span class="text-red">Away</span>
                    </button>
                    <button class="alarm-btn outside" data-action="armAlarm" data-param-mode="arm_custom_bypass">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="text-blue">Outside</span>
                    </button>
                    <button class="alarm-btn disarm" data-action="armAlarm" data-param-mode="disarm">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"/>
                        </svg>
                        <span class="text-emerald">Disarm</span>
                    </button>
                </div>

                <!-- Dog Mode Toggle -->
                <div id="dogModeCard" class="security-status-card" style="margin-top: 16px; background: rgba(251, 146, 60, 0.1); border: 1px solid rgba(251, 146, 60, 0.2);">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div class="room-icon" style="background: rgba(251, 146, 60, 0.2);">
                                <svg style="width: 20px; height: 20px; color: #fb923c;" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M18 4c-.55 0-1.05.22-1.41.59L12 9.17 7.41 4.59C7.05 4.22 6.55 4 6 4c-1.1 0-2 .9-2 2v2c0 .55.22 1.05.59 1.41l3 3c.18.18.43.3.7.35L5.5 15.5c-.55.55-.85 1.29-.85 2.06V19c0 1.1.9 2 2 2h10.7c1.1 0 2-.9 2-2v-1.44c0-.77-.3-1.51-.85-2.06l-2.79-2.74c.27-.05.52-.17.7-.35l3-3c.37-.36.59-.86.59-1.41V6c0-1.1-.9-2-2-2z"/>
                                </svg>
                            </div>
                            <div>
                                <div style="font-size: 0.9375rem; font-weight: 600; color: #fb923c;">Dog Mode</div>
                                <div style="font-size: 0.75rem; color: var(--text-tertiary);">Person-only alerts</div>
                            </div>
                        </div>
                        <button id="dogModeToggle" data-action="toggleDogMode" style="width: 48px; height: 28px; border-radius: 14px; background: rgba(255,255,255,0.1); border: none; position: relative; cursor: pointer; transition: background 0.2s;">
                            <div id="dogModeKnob" style="width: 22px; height: 22px; background: rgba(255,255,255,0.6); border-radius: 50%; position: absolute; top: 3px; left: 3px; transition: transform 0.2s;"></div>
                        </button>
                    </div>
                </div>

                <!-- Critical Alerts Toggle -->
                <div id="criticalAlertsCard" class="security-status-card" style="margin-top: 12px; background: rgba(236, 72, 153, 0.1); border: 1px solid rgba(236, 72, 153, 0.2);">
                    <div style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                        <button data-action="showCriticalAlertsConfig" style="display: flex; align-items: center; gap: 12px; background: none; border: none; cursor: pointer; padding: 0;">
                            <div class="room-icon" style="background: rgba(236, 72, 153, 0.2);">
                                <svg style="width: 20px; height: 20px; color: #ec4899;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                                </svg>
                            </div>
                            <div style="text-align: left;">
                                <div style="font-size: 0.9375rem; font-weight: 600; color: #ec4899;">Critical Alerts</div>
                                <div id="mCriticalAlertsStatus" style="font-size: 0.75rem; color: var(--text-tertiary);">Off - tap to configure</div>
                            </div>
                        </button>
                        <button id="mCriticalAlertsToggle" data-action="toggleCriticalAlerts" style="width: 48px; height: 28px; border-radius: 14px; background: rgba(255,255,255,0.1); border: none; position: relative; cursor: pointer; transition: background 0.2s;">
                            <div id="mCriticalAlertsKnob" style="width: 22px; height: 22px; background: rgba(255,255,255,0.6); border-radius: 50%; position: absolute; top: 3px; left: 3px; transition: transform 0.2s;"></div>
                        </button>
                    </div>
                </div>

                <!-- Emergency Panic Buttons -->
                <div style="margin-top: 16px;">
                    <div style="font-size: 0.6875rem; font-weight: 600; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 8px;">Emergency Panic</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                        <button data-action="triggerPanicButton" data-param-type="police" style="padding: 12px 8px; border-radius: 12px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); cursor: pointer; text-align: center;">
                            <svg style="width: 24px; height: 24px; color: #ef4444; margin: 0 auto 4px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                            </svg>
                            <div style="font-size: 0.625rem; font-weight: 700; color: #ef4444;">POLICE</div>
                        </button>
                        <button data-action="triggerPanicButton" data-param-type="fire" style="padding: 12px 8px; border-radius: 12px; background: rgba(249, 115, 22, 0.1); border: 1px solid rgba(249, 115, 22, 0.3); cursor: pointer; text-align: center;">
                            <svg style="width: 24px; height: 24px; color: #f97316; margin: 0 auto 4px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"/>
                            </svg>
                            <div style="font-size: 0.625rem; font-weight: 700; color: #f97316;">FIRE</div>
                        </button>
                        <button data-action="triggerPanicButton" data-param-type="ambulance" style="padding: 12px 8px; border-radius: 12px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); cursor: pointer; text-align: center;">
                            <svg style="width: 24px; height: 24px; color: #3b82f6; margin: 0 auto 4px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                            <div style="font-size: 0.625rem; font-weight: 700; color: #3b82f6;">MEDICAL</div>
                        </button>
                    </div>
                </div>

                <!-- Delayed Exit Button -->
                <button data-action="showDelayedExit" style="margin-top: 16px; width: 100%; padding: 16px; border-radius: 16px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(168, 85, 247, 0.15)); border: 1px solid rgba(139, 92, 246, 0.3); display: flex; align-items: center; gap: 12px; cursor: pointer;">
                    <div style="width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(135deg, #8b5cf6, #a855f7); display: flex; align-items: center; justify-content: center;">
                        <svg style="width: 22px; height: 22px; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div style="text-align: left;">
                        <div style="font-size: 1rem; font-weight: 600; color: #a855f7;">Delayed Exit</div>
                        <div style="font-size: 0.75rem; color: var(--text-tertiary);">3 minute countdown before arming</div>
                    </div>
                    <svg style="width: 20px; height: 20px; color: var(--text-tertiary); margin-left: auto;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>

                <div class="section-header">
                    <h3 class="section-title">Zones</h3>
                    <span id="zoneStats" style="font-size: 0.75rem; color: var(--text-tertiary);">0 active</span>
                </div>
                <div id="zonesGrid" class="zones-list">
                    <!-- Zones populated by JS -->
                </div>
            </main>
        </div>

        <!-- Energy View - Neo-Tokyo -->
        <div id="view-energy" class="view hidden">
            <header class="mobile-header">
                <div class="section-header" style="margin: 0;">
                    <h2 class="section-title">Energy</h2>
                    <button class="modal-close" data-action="showView" data-param-view="home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="mobile-content">
                <!-- Energy Overview Cards -->
                <div class="energy-overview">
                    <!-- Solar -->
                    <div class="energy-card-neo solar">
                        <div class="energy-card-header">
                            <div class="energy-card-icon">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                                </svg>
                            </div>
                            <span class="energy-card-label">Solar</span>
                        </div>
                        <div class="energy-card-value" id="solarPower">0W</div>
                        <div class="energy-card-sub">Production</div>
                    </div>

                    <!-- Battery -->
                    <div class="energy-card-neo battery">
                        <div class="energy-card-header">
                            <div class="energy-card-icon">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h14a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4a2 2 0 012-2zm16 3h2m-2 0v2"/>
                                </svg>
                            </div>
                            <span class="energy-card-label">Battery</span>
                        </div>
                        <div class="energy-card-value" id="batteryPercent">--%</div>
                        <div class="energy-card-sub" id="batteryState">Standby</div>
                        <div class="battery-bar-container">
                            <div class="battery-bar-fill" id="batteryBarFill" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Grid -->
                    <div class="energy-card-neo grid">
                        <div class="energy-card-header">
                            <div class="energy-card-icon">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                </svg>
                            </div>
                            <span class="energy-card-label">Grid</span>
                        </div>
                        <div class="energy-card-value" id="gridPower">0W</div>
                        <div class="energy-card-sub" id="gridDirection">Idle</div>
                    </div>

                    <!-- Load -->
                    <div class="energy-card-neo load">
                        <div class="energy-card-header">
                            <div class="energy-card-icon">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                                </svg>
                            </div>
                            <span class="energy-card-label">House</span>
                        </div>
                        <div class="energy-card-value" id="loadPower">0W</div>
                        <div class="energy-card-sub">Consumption</div>
                    </div>
                </div>

                <!-- Power Trend Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <span class="chart-title">Power Trend</span>
                        <div class="chart-legend">
                            <span class="legend-item"><span class="legend-dot actual"></span>Now</span>
                            <span class="legend-item"><span class="legend-dot avg"></span>Avg</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="energyTrendChart"></canvas>
                    </div>
                    <div class="chart-time-labels">
                        <span>-6h</span>
                        <span>-5h</span>
                        <span>-4h</span>
                        <span>-3h</span>
                        <span>-2h</span>
                        <span>-1h</span>
                        <span>Now</span>
                    </div>
                </div>

                <!-- Appliances -->
                <div class="appliances-title">Appliances</div>
                <div class="appliances-grid">
                    <!-- Geyser -->
                    <div class="appliance-card">
                        <div class="appliance-header">
                            <div class="appliance-icon" style="background: rgba(249, 115, 22, 0.15); color: var(--accent-orange);">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"/>
                                </svg>
                            </div>
                            <button id="geyserToggle" class="toggle-switch" data-action="toggleEntity" data-param-entity="switch.sonoff_10018908af"></button>
                        </div>
                        <div class="appliance-name">Geyser</div>
                        <div class="appliance-power" id="geyserPower">0W</div>
                        <div class="appliance-status" id="geyserStatus">Off</div>
                    </div>

                    <!-- Washer -->
                    <div class="appliance-card">
                        <div class="appliance-header">
                            <div class="appliance-icon" style="background: rgba(59, 130, 246, 0.15); color: var(--accent-blue);">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                </svg>
                            </div>
                        </div>
                        <div class="appliance-name">Washer</div>
                        <div class="appliance-power" id="washerPower">0W</div>
                        <div class="appliance-status" id="washerStatus">Idle</div>
                    </div>

                    <!-- Dishwasher -->
                    <div class="appliance-card">
                        <div class="appliance-header">
                            <div class="appliance-icon" style="background: rgba(34, 211, 238, 0.15); color: var(--accent-cyan);">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                </svg>
                            </div>
                        </div>
                        <div class="appliance-name">Dishwasher</div>
                        <div class="appliance-power" id="dishwasherPower">0W</div>
                        <div class="appliance-status" id="dishwasherStatus">Idle</div>
                    </div>

                    <!-- Pool Pump -->
                    <div class="appliance-card">
                        <div class="appliance-header">
                            <div class="appliance-icon" style="background: rgba(20, 184, 166, 0.15); color: var(--accent-teal);">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                                </svg>
                            </div>
                            <button id="pumpToggle" class="toggle-switch" data-action="toggleEntity" data-param-entity="switch.sonoff_10017f2d90_1"></button>
                        </div>
                        <div class="appliance-name">Pool Pump</div>
                        <div class="appliance-power" id="pumpPower">0W</div>
                        <div class="appliance-status" id="pumpStatus">Off</div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Family View - iOS Premium Redesign -->
        <div id="view-family" class="view hidden">
            <header class="mobile-header">
                <div class="family-header">
                    <div>
                        <h1 class="family-title">Family</h1>
                        <div class="family-subtitle" id="familyLastUpdate">Updated just now</div>
                    </div>
                    <button class="modal-close" data-action="showView" data-param-view="home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="mobile-content">
                <!-- Battery Alerts (Compact pills) -->
                <div id="familyBatteryAlerts" class="battery-alerts-container"></div>

                <!-- Who's Home - Hero Card -->
                <div class="family-home-hero">
                    <div class="home-hero-content">
                        <div class="home-hero-left">
                            <span class="home-hero-label">At Home</span>
                            <span class="home-hero-count" id="familyHomeCount">0</span>
                            <span class="home-hero-names" id="familyHomeNames">Loading...</span>
                        </div>
                        <div class="home-avatars-stack" id="familyHomeAvatars"></div>
                    </div>
                </div>

                <!-- Family Member Cards - 2x2 Grid -->
                <div class="family-section-label">Activity</div>
                <div class="family-cards-grid" id="familyCardsGrid"></div>

                <!-- Steps Competition Card -->
                <div class="steps-competition">
                    <div class="steps-header">
                        <div class="steps-title">
                            <div class="steps-icon">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                </svg>
                            </div>
                            <span class="steps-title-text">Today's Steps</span>
                        </div>
                        <div class="steps-total">
                            <div class="steps-total-value" id="familyTotalSteps">0</div>
                            <div class="steps-total-label">Total</div>
                        </div>
                    </div>
                    <div class="steps-leaderboard" id="familyStepsLeaderboard"></div>
                </div>

                <!-- Additional Metrics -->
                <div class="metrics-section">
                    <div class="family-section-label">More Stats</div>
                    <div class="metrics-tabs">
                        <button class="metric-tab active" data-action="switchFamilyMetric" data-param-metric="floors" id="tab-floors">Floors</button>
                        <button class="metric-tab" data-action="switchFamilyMetric" data-param-metric="distance" id="tab-distance">Distance</button>
                    </div>
                    <div class="metrics-leaderboard" id="familyMetricsLeaderboard"></div>
                </div>
            </main>
        </div>

        <!-- Calendar View - Mobile Optimized Agenda Style -->
        <div id="view-calendar" class="view hidden">
            <header class="mobile-header cal-header">
                <div class="cal-header-main">
                    <button class="cal-nav-btn" data-action="calendarPrevMonth">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <button class="cal-month-title" data-action="toggleMiniCalendar">
                        <span id="calMonthYear">December 2025</span>
                        <svg class="cal-dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <button class="cal-nav-btn" data-action="calendarNextMonth">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </button>
                </div>
                <button class="cal-today-btn" data-action="calendarGoToday">Today</button>
            </header>

            <!-- Mini Calendar (Expandable) -->
            <div id="miniCalendarContainer" class="mini-calendar-container collapsed">
                <div class="mini-calendar-grid" id="miniCalendarGrid"></div>
            </div>

            <!-- Week Strip with Navigation -->
            <div class="week-strip-wrapper">
                <button class="week-nav-btn prev" data-action="calendarPrevWeek">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                </button>
                <div class="week-strip" id="weekStrip">
                    <div class="week-strip-scroll" id="weekStripScroll"></div>
                </div>
                <button class="week-nav-btn next" data-action="calendarNextWeek">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>

            <!-- View Mode Toggle -->
            <div class="cal-view-toggle">
                <button class="cal-view-btn" data-mode="day" data-action="setCalendarViewMode" data-param-mode="day">Day</button>
                <button class="cal-view-btn active" data-mode="week" data-action="setCalendarViewMode" data-param-mode="week">Week</button>
                <button class="cal-view-btn" data-mode="all" data-action="setCalendarViewMode" data-param-mode="all">All</button>
            </div>

            <!-- Agenda Content -->
            <main class="mobile-content cal-content">
                <!-- Quick Stats -->
                <div class="cal-stats">
                    <div class="cal-stat">
                        <span class="cal-stat-value" id="calTodayCount">0</span>
                        <span class="cal-stat-label">Today</span>
                    </div>
                    <div class="cal-stat">
                        <span class="cal-stat-value" id="calWeekCount">0</span>
                        <span class="cal-stat-label">This Week</span>
                    </div>
                    <div class="cal-stat">
                        <span class="cal-stat-value" id="calUpcomingCount">0</span>
                        <span class="cal-stat-label">Upcoming</span>
                    </div>
                </div>

                <!-- Agenda List -->
                <div class="agenda-container" id="agendaContainer">
                    <div class="agenda-loading">
                        <div class="spinner"></div>
                        <span>Loading events...</span>
                    </div>
                </div>
            </main>

            <!-- Floating Action Button -->
            <button class="cal-fab" data-action="openQuickAddEvent">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
            </button>
        </div>

        <!-- Calendar Event Modal -->
        <div id="calEventModal" class="cal-modal hidden">
            <div class="modal-backdrop" data-action="closeCalEventModal"></div>
            <div class="cal-modal-sheet">
                <div class="modal-handle"></div>
                <div class="cal-modal-header">
                    <h3 id="calEventTitle">Event Title</h3>
                    <button class="cal-modal-close" data-action="closeCalEventModal">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                <div class="cal-modal-body">
                    <div class="cal-event-detail">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span id="calEventTime">All day</span>
                    </div>
                    <div class="cal-event-detail">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        <span id="calEventDate">Thursday, December 26</span>
                    </div>
                    <div class="cal-event-detail" id="calEventLocationRow">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                        </svg>
                        <span id="calEventLocation"></span>
                    </div>
                    <div class="cal-event-detail" id="calEventDescRow">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"/>
                        </svg>
                        <span id="calEventDesc"></span>
                    </div>
                    <div class="cal-event-detail" id="calEventAssigneeRow">
                        <div class="cal-event-assignee" id="calEventAssignee"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Add Event Modal -->
        <div id="calQuickAddModal" class="cal-modal hidden">
            <div class="modal-backdrop" data-action="closeQuickAddModal"></div>
            <div class="cal-modal-sheet cal-add-sheet">
                <div class="modal-handle"></div>
                <div class="cal-modal-header">
                    <h3>New Event</h3>
                    <button class="cal-save-btn" data-action="saveQuickEvent">Save</button>
                </div>
                <div class="cal-modal-body">
                    <input type="text" id="quickEventTitle" class="cal-input" placeholder="Event title" autocomplete="off">
                    <div class="cal-input-row">
                        <input type="date" id="quickEventDate" class="cal-input">
                        <label class="cal-checkbox">
                            <input type="checkbox" id="quickEventAllDay" checked onchange="toggleQuickEventTime()">
                            <span>All day</span>
                        </label>
                    </div>
                    <div class="cal-time-row hidden" id="quickTimeRow">
                        <input type="time" id="quickEventStart" class="cal-input" value="09:00">
                        <span class="cal-time-sep">to</span>
                        <input type="time" id="quickEventEnd" class="cal-input" value="10:00">
                    </div>
                    <select id="quickEventAssignee" class="cal-input">
                        <option value="everyone">Everyone</option>
                        <option value="person2">Person2</option>
                        <option value="person1">Person1</option>
                        <option value="child1">Child1</option>
                        <option value="child2">Child2</option>
                    </select>
                    <textarea id="quickEventDesc" class="cal-input cal-textarea" placeholder="Add description (optional)"></textarea>
                </div>
            </div>
        </div>

        <!-- AI Surveillance View - Mobile Optimized -->
        <div id="view-surveillance" class="view hidden">
            <header class="mobile-header">
                <div class="surv-header">
                    <div class="surv-title-wrap">
                        <div class="surv-icon-ring">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div class="surv-title-text">
                            <h2>AI SURVEILLANCE</h2>
                            <span id="survMobileLastUpdate">CONNECTING...</span>
                        </div>
                    </div>
                    <button class="modal-close" data-action="showView" data-param-view="home">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </header>
            <main class="mobile-content">
                <!-- Stats Bar -->
                <div class="surv-stats-bar">
                    <div class="surv-stat">
                        <span class="surv-stat-value" style="color: #f43f5e;" id="survMobileTodayEvents">0</span>
                        <span class="surv-stat-label">Events</span>
                    </div>
                    <div class="surv-stat">
                        <span class="surv-stat-value" style="color: #fbbf24;" id="survMobilePersonCount">0</span>
                        <span class="surv-stat-label">People</span>
                    </div>
                    <div class="surv-stat">
                        <span class="surv-stat-value" style="color: #3b82f6;" id="survMobileVehicleCount">0</span>
                        <span class="surv-stat-label">Vehicles</span>
                    </div>
                    <div class="surv-stat">
                        <span class="surv-stat-value" style="color: #10b981;" id="survMobileAiCount">0</span>
                        <span class="surv-stat-label">AI</span>
                    </div>
                </div>

                <!-- Time Filter Pills -->
                <div class="surv-filters">
                    <button class="surv-filter-btn active" data-action="setSurvTimeFilter" data-param-filter="1h" data-time="1h">1 Hour</button>
                    <button class="surv-filter-btn" data-action="setSurvTimeFilter" data-param-filter="6h" data-time="6h">6 Hours</button>
                    <button class="surv-filter-btn" data-action="setSurvTimeFilter" data-param-filter="24h" data-time="24h">24 Hours</button>
                    <button class="surv-filter-btn" data-action="setSurvObjectFilter" data-param-filter="person" data-obj="person">
                        <svg fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/></svg>
                        Person
                    </button>
                    <button class="surv-filter-btn" data-action="setSurvObjectFilter" data-param-filter="car" data-obj="car">
                        <svg fill="currentColor" viewBox="0 0 20 20"><path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/><path d="M3 9l2-4h10l2 4M3 9v6h14V9M3 9h14"/></svg>
                        Vehicle
                    </button>
                </div>

                <!-- Events List -->
                <div class="surv-events-list" id="survMobileEventsList">
                    <!-- Loading State -->
                    <div class="surv-empty" id="survMobileLoading">
                        <svg class="animate-spin" fill="none" viewBox="0 0 24 24">
                            <circle style="opacity: 0.25;" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path style="opacity: 0.75;" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <h3>Connecting to Frigate...</h3>
                        <p>Loading camera events</p>
                    </div>
                </div>
            </main>
        </div>

        <!-- AI Surveillance Event Detail Modal -->
        <div id="survDetailModal" class="surv-detail-modal hidden">
            <div class="surv-detail-header">
                <div class="surv-title-wrap">
                    <span id="survDetailLabel" class="surv-event-label person">PERSON</span>
                    <span id="survDetailCamera" style="color: var(--text-secondary); font-size: 0.875rem;">Front Door</span>
                </div>
                <button class="surv-detail-close" data-action="closeSurvDetailModal">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="surv-detail-media">
                <img id="survDetailImage" src="" alt="Event snapshot">
                <video id="survDetailVideo" class="hidden" controls></video>
            </div>
            <div class="surv-detail-content">
                <div style="margin-bottom: var(--spacing-md);">
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px;">TIME</div>
                    <div id="survDetailTime" style="font-size: 0.9375rem; color: var(--text-primary);">--</div>
                </div>
                <div style="margin-bottom: var(--spacing-md);">
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px;">CONFIDENCE</div>
                    <div id="survDetailConfidence" style="font-size: 0.9375rem; color: var(--text-primary);">--</div>
                </div>
                <div>
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px;">AI ANALYSIS</div>
                    <div id="survDetailAI" class="surv-event-ai">No analysis available</div>
                </div>
            </div>
            <div class="surv-detail-actions">
                <button class="surv-detail-btn primary" data-action="playSurvClip">
                    <svg fill="currentColor" viewBox="0 0 20 20"><path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"/></svg>
                    Play Clip
                </button>
                <button class="surv-detail-btn secondary" data-action="downloadSurvClip">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                    Save
                </button>
            </div>
        </div>

        <!-- Alexa Announcements View - Mobile Optimized -->
        <div id="view-alexa" class="view hidden">
            <header class="mobile-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="width: 40px; height: 40px; border-radius: 12px; background: rgba(59, 130, 246, 0.2); display: flex; align-items: center; justify-content: center; border: 1px solid rgba(59, 130, 246, 0.3);">
                        <svg style="width: 20px; height: 20px; color: #3b82f6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
                        </svg>
                    </div>
                    <div>
                        <h2 style="font-size: 1.25rem; font-weight: bold; color: white; margin: 0;">Alexa</h2>
                        <span style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Home Announcements</span>
                    </div>
                </div>
                <button data-action="showView" data-param-view="home" style="background: rgba(255,255,255,0.1); border: none; border-radius: 12px; padding: 8px; cursor: pointer;">
                    <svg style="width: 20px; height: 20px; color: rgba(255,255,255,0.7);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </header>

            <div class="view-content" style="padding: 16px; overflow-y: auto;">
                <!-- Delivery Section -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px;">Delivery</h3>
                    <button data-action="startDeliveryMode" class="alexa-mobile-btn" style="width: 100%; background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2)); border: 1px solid rgba(16, 185, 129, 0.4); padding: 16px;">
                        <svg style="width: 28px; height: 28px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"/>
                        </svg>
                        <span style="font-size: 1rem; font-weight: 600;">Start Delivery Mode</span>
                        <span style="font-size: 0.7rem; color: rgba(255,255,255,0.5); display: block; margin-top: 4px;">Opens garage & announces until closed</span>
                    </button>
                </div>

                <!-- Food Announcements Section -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px;">Food Ready</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <button data-action="alexaAnnounce" data-param-message="Girls, food is ready! Please come down." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(234, 88, 12, 0.15)); border: 1px solid rgba(249, 115, 22, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #f97316;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            <span>Girls Food Ready</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Everyone, food is ready! Please come to the table." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(234, 88, 12, 0.15)); border: 1px solid rgba(249, 115, 22, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #f97316;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                            </svg>
                            <span>Everyone Food</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Baba, food is ready!" class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(234, 88, 12, 0.15)); border: 1px solid rgba(249, 115, 22, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #f97316;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            <span>Baba Food Ready</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Girls, please come downstairs." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.15), rgba(139, 92, 246, 0.15)); border: 1px solid rgba(168, 85, 247, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #a855f7;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                            </svg>
                            <span>Girls Come Down</span>
                        </button>
                    </div>
                </div>

                <!-- Individual Calls Section -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px;">Individual Calls</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <button data-action="alexaAnnounce" data-param-message="Child1, please come downstairs." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(219, 39, 119, 0.15)); border: 1px solid rgba(236, 72, 153, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #ec4899;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                            </svg>
                            <span>Child1 Down</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Child2, please come downstairs." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(34, 211, 238, 0.15), rgba(6, 182, 212, 0.15)); border: 1px solid rgba(34, 211, 238, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #22d3ee;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                            </svg>
                            <span>Child2 Down</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Child1, please come to my room." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(219, 39, 119, 0.15)); border: 1px solid rgba(236, 72, 153, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #ec4899;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            <span>Child1 To Room</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Child2, please come to my room." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(34, 211, 238, 0.15), rgba(6, 182, 212, 0.15)); border: 1px solid rgba(34, 211, 238, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #22d3ee;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                            <span>Child2 To Room</span>
                        </button>
                    </div>
                </div>

                <!-- Routine Announcements Section -->
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px;">Routines</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <button data-action="alexaAnnounce" data-param-message="Girls, it's time for bed. Please go brush your teeth." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(79, 70, 229, 0.15)); border: 1px solid rgba(99, 102, 241, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #6366f1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                            </svg>
                            <span>Bedtime</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Time to leave! Everyone get ready." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(79, 70, 229, 0.15)); border: 1px solid rgba(99, 102, 241, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #6366f1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <span>Time to Leave</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Movie time! Come to the living room." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(79, 70, 229, 0.15)); border: 1px solid rgba(99, 102, 241, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #6366f1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"/>
                            </svg>
                            <span>Movie Time</span>
                        </button>
                        <button data-action="alexaAnnounce" data-param-message="Girls, homework time! Please start your homework." class="alexa-mobile-btn" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(79, 70, 229, 0.15)); border: 1px solid rgba(99, 102, 241, 0.3);">
                            <svg style="width: 24px; height: 24px; color: #6366f1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                            </svg>
                            <span>Homework</span>
                        </button>
                    </div>
                </div>

                <!-- Custom Message -->
                <div style="margin-bottom: 80px;">
                    <h3 style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.5); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px;">Custom Message</h3>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="alexaCustomInput" placeholder="Type custom announcement..." style="flex: 1; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 12px 16px; color: white; font-size: 0.875rem;">
                        <button data-action="alexaCustomAnnounce" style="background: linear-gradient(135deg, #3b82f6, #2563eb); border: none; border-radius: 12px; padding: 12px 20px; color: white; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            <svg style="width: 20px; height: 20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
                            </svg>
                            Send
                        </button>
                    </div>
                </div>
            </div>

            <!-- Alexa Feedback Toast -->
            <div id="alexaFeedbackToast" style="position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%) translateY(100px); opacity: 0; background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 12px 24px; border-radius: 12px; font-weight: 600; display: flex; align-items: center; gap: 8px; transition: all 0.3s ease; z-index: 1000;">
                <svg style="width: 20px; height: 20px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                Sent!
            </div>
        </div>

        <!-- Guest Pass View - Mobile Optimized -->
        <div id="view-guest-pass" class="view hidden">
            <header class="mobile-header">
                <div class="guest-header">
                    <div class="guest-icon-wrap">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
                        </svg>
                    </div>
                    <div class="guest-title">
                        <h2>Guest Passes</h2>
                        <span>Golden Ticket Generator</span>
                    </div>
                </div>
                <button class="modal-close" data-action="showView" data-param-view="home">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </header>
            <main class="mobile-content">
                <!-- Duration Presets -->
                <div class="guest-presets">
                    <button class="guest-preset active" data-action="setGuestPreset" data-param-preset="day" data-preset="day">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
                        </svg>
                        <span>24h</span>
                    </button>
                    <button class="guest-preset" data-action="setGuestPreset" data-param-preset="week" data-preset="week">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        <span>Week</span>
                    </button>
                    <button class="guest-preset" data-action="setGuestPreset" data-param-preset="month" data-preset="month">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                        <span>Month</span>
                    </button>
                    <button class="guest-preset" data-action="setGuestPreset" data-param-preset="lifetime" data-preset="lifetime">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/>
                        </svg>
                        <span>Forever</span>
                    </button>
                </div>

                <!-- Create Pass Form -->
                <div class="guest-form">
                    <input type="text" id="guestMobileName" class="guest-input" placeholder="Guest name (e.g., John Smith)">

                    <div class="guest-permissions">
                        <div class="guest-perm-item">
                            <input type="checkbox" id="guestMobilePermGate" checked>
                            <label for="guestMobilePermGate">
                                <div class="guest-perm-icon gate">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"/>
                                    </svg>
                                </div>
                                Gate
                            </label>
                        </div>
                        <div class="guest-perm-item">
                            <input type="checkbox" id="guestMobilePermGarage" checked>
                            <label for="guestMobilePermGarage">
                                <div class="guest-perm-icon garage">
                                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                                    </svg>
                                </div>
                                Garage
                            </label>
                        </div>
                    </div>

                    <button class="guest-generate-btn" data-action="generateGuestPass">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
                        </svg>
                        Generate Golden Ticket
                    </button>
                </div>

                <!-- Active Passes -->
                <div class="guest-passes-header">
                    <h3>Active Passes</h3>
                    <span class="guest-passes-count" id="guestMobilePassCount">0 active</span>
                </div>
                <div class="guest-passes-list" id="guestMobilePassesList">
                    <div class="guest-empty">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
                        </svg>
                        <h3>No active passes</h3>
                        <p>Create one to share access with guests</p>
                    </div>
                </div>
            </main>
        </div>

        <!-- Generated Pass Modal -->
        <div id="guestMobilePassModal" class="guest-modal hidden">
            <div class="guest-modal-backdrop" data-action="closeGuestPassModal"></div>
            <div class="guest-modal-sheet">
                <div class="guest-modal-handle"></div>
                <div class="guest-modal-header">
                    <div class="guest-modal-icon">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                    </div>
                    <div class="guest-modal-title">
                        <h3>Pass Generated!</h3>
                        <span id="guestModalName">Guest Name</span>
                    </div>
                </div>
                <div class="guest-modal-url">
                    <input type="text" id="guestModalUrl" readonly>
                    <button class="guest-modal-copy" data-action="copyGuestPassUrl">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        <span id="guestCopyBtnText">Copy</span>
                    </button>
                </div>
                <div class="guest-modal-share">
                    <button class="guest-share-btn whatsapp" data-action="shareGuestPassWhatsApp">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        WhatsApp
                    </button>
                    <button class="guest-share-btn share" data-action="shareGuestPassNative">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                        </svg>
                        Share
                    </button>
                </div>
                <div class="guest-modal-validity" id="guestModalValidity">Valid for 24 hours</div>
            </div>
        </div>

        <!-- More Menu Overlay -->
        <div id="moreMenuOverlay" class="more-menu-overlay hidden">
            <div class="more-menu-backdrop" data-action="closeMoreMenu"></div>
            <div class="more-menu-sheet">
                <div class="more-menu-handle"></div>
                <div class="more-menu-grid">
                    <button class="more-menu-item" data-action="showViewAndCloseMenu" data-param-view="surveillance">
                        <div class="more-menu-icon ai">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <span>AI Surveillance</span>
                    </button>
                    <button class="more-menu-item" data-action="showViewAndCloseMenu" data-param-view="guest-pass">
                        <div class="more-menu-icon guest">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"/>
                            </svg>
                        </div>
                        <span>Guest Pass</span>
                    </button>
                    <button class="more-menu-item" data-action="showViewAndCloseMenu" data-param-view="family">
                        <div class="more-menu-icon family">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                        </div>
                        <span>Family</span>
                    </button>
                    <button class="more-menu-item" data-action="showViewAndCloseMenu" data-param-view="energy">
                        <div class="more-menu-icon energy">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                        </div>
                        <span>Energy</span>
                    </button>
                    <button class="more-menu-item" data-action="showViewAndCloseMenu" data-param-view="alexa">
                        <div class="more-menu-icon alexa">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
                            </svg>
                        </div>
                        <span>Alexa</span>
                    </button>
                    <button class="more-menu-item" data-action="closeMoreMenu">
                        <div class="more-menu-icon settings">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            </svg>
                        </div>
                        <span>Settings</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation (5 items - with More menu) -->
        <nav class="bottom-nav">
            <button id="nav-home" class="nav-item active" data-action="showView" data-param-view="home">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                <span>Home</span>
            </button>
            <button id="nav-cameras" class="nav-item" data-action="showView" data-param-view="cameras">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                <span>Cams</span>
            </button>
            <button id="nav-calendar" class="nav-item" data-action="showView" data-param-view="calendar">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                </svg>
                <span>Calendar</span>
            </button>
            <button id="nav-security" class="nav-item" data-action="showView" data-param-view="security">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                </svg>
                <span>Secure</span>
            </button>
            <button id="nav-more" class="nav-item" data-action="openMoreMenu">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
                <span>More</span>
            </button>
        </nav>
    </div>

    <!-- Room Modal -->
    <div id="roomModal" class="hidden">
        <div class="modal-backdrop" data-action="closeRoomModal"></div>
        <div id="roomModalSheet" class="modal-sheet">
            <div class="modal-handle"></div>
            <div class="modal-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div id="modalRoomIcon" class="room-icon"></div>
                    <div>
                        <h3 id="modalRoomName" class="modal-title">Room</h3>
                        <span id="modalRoomStatus" style="font-size: 0.875rem; color: var(--text-tertiary);">0 lights on</span>
                    </div>
                </div>
                <button class="modal-close" data-action="closeRoomModal">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-content">
                <div id="modalMasterControls" class="master-controls"></div>
                <div id="modalLightGrid" class="light-grid"></div>
            </div>
        </div>
    </div>

    <!-- All Lights Modal -->
    <div id="allLightsModal" class="hidden">
        <div class="modal-backdrop" data-action="closeAllLightsModal"></div>
        <div id="allLightsModalSheet" class="modal-sheet">
            <div class="modal-handle"></div>
            <div class="modal-header">
                <div>
                    <h3 class="modal-title">All Lights</h3>
                    <span id="allLightsCount" style="font-size: 0.875rem; color: var(--text-tertiary);">0 lights on</span>
                </div>
                <button class="master-btn all-off" style="padding: 8px 16px;" data-action="allLightsOffAndClose">
                    <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
                    </svg>
                    All Off
                </button>
            </div>
            <div class="modal-content">
                <div id="allLightsGrid" class="light-grid"></div>
            </div>
        </div>
    </div>

    <!-- Delayed Exit Overlay -->
    <div id="delayedExitOverlay" class="delayed-exit-overlay" style="display: none; position: fixed; inset: 0; z-index: 9999; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);">
        <!-- Mode Selection View -->
        <div id="exitModeSelection" style="height: 100%; display: flex; flex-direction: column; padding: 24px; padding-top: env(safe-area-inset-top, 24px);">
            <div style="text-align: center; margin-bottom: 32px;">
                <h1 style="font-size: 1.5rem; font-weight: 300; letter-spacing: 0.2em; color: rgba(255,255,255,0.9); margin-bottom: 8px;">DELAYED EXIT</h1>
                <p style="font-size: 0.875rem; color: rgba(255,255,255,0.4);">Select mode - 3 min countdown begins</p>
            </div>

            <div style="flex: 1; display: flex; flex-direction: column; gap: 16px; justify-content: center;">
                <!-- Arm Away -->
                <button data-action="selectExitMode" data-param-mode="arm_away" style="padding: 20px; border-radius: 20px; background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); display: flex; align-items: center; gap: 16px; cursor: pointer;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, #ef4444, #f97316); display: flex; align-items: center; justify-content: center;">
                        <svg style="width: 28px; height: 28px; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                    </div>
                    <div style="text-align: left;">
                        <div style="font-size: 1.125rem; font-weight: 600; color: white;">ARM AWAY</div>
                        <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Full protection</div>
                    </div>
                </button>

                <!-- Arm Stay -->
                <button data-action="selectExitMode" data-param-mode="arm_home" style="padding: 20px; border-radius: 20px; background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); display: flex; align-items: center; gap: 16px; cursor: pointer;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, #f59e0b, #eab308); display: flex; align-items: center; justify-content: center;">
                        <svg style="width: 28px; height: 28px; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                        </svg>
                    </div>
                    <div style="text-align: left;">
                        <div style="font-size: 1.125rem; font-weight: 600; color: white;">ARM STAY</div>
                        <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Perimeter only</div>
                    </div>
                </button>

                <!-- Dog Mode -->
                <button data-action="selectExitMode" data-param-mode="dog_mode" style="padding: 20px; border-radius: 20px; background: rgba(6,182,212,0.1); border: 1px solid rgba(6,182,212,0.3); display: flex; align-items: center; gap: 16px; cursor: pointer;">
                    <div style="width: 56px; height: 56px; border-radius: 16px; background: linear-gradient(135deg, #06b6d4, #3b82f6); display: flex; align-items: center; justify-content: center;">
                        <svg style="width: 28px; height: 28px; color: white;" viewBox="0 0 256 256" fill="currentColor">
                            <path d="M240,108a28,28,0,1,1-28-28A28.1,28.1,0,0,1,240,108ZM72,108a28,28,0,1,0-28,28A28.1,28.1,0,0,0,72,108ZM92,88A28,28,0,1,0,64,60,28.1,28.1,0,0,0,92,88Zm72,0a28,28,0,1,0-28-28A28.1,28.1,0,0,0,164,88Zm23.1,60.8a35.3,35.3,0,0,1-16.9-21.1,43.9,43.9,0,0,0-84.4,0A35.5,35.5,0,0,1,69,148.8,40,40,0,0,0,88,224a40.5,40.5,0,0,0,15.5-3.1,64.2,64.2,0,0,1,48.9-.1A39.6,39.6,0,0,0,168,224a40,40,0,0,0,19.1-75.2Z"/>
                        </svg>
                    </div>
                    <div style="text-align: left;">
                        <div style="font-size: 1.125rem; font-weight: 600; color: white;">DOG MODE</div>
                        <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">AI person detection</div>
                    </div>
                </button>
            </div>

            <button data-action="hideDelayedExit" style="margin-top: 24px; padding: 16px; border-radius: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.6); font-size: 1rem; cursor: pointer;">
                CANCEL
            </button>
        </div>

        <!-- Countdown View -->
        <div id="exitCountdownView" style="display: none; height: 100%; flex-direction: column; align-items: center; justify-content: center; padding: 24px;">
            <!-- Target State -->
            <div id="exitTargetBadge" style="display: flex; align-items: center; gap: 12px; padding: 12px 20px; border-radius: 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); margin-bottom: 40px;">
                <div id="exitTargetIconMobile" style="width: 32px; height: 32px;"></div>
                <div>
                    <div id="exitTargetLabelMobile" style="font-size: 1rem; font-weight: 600; color: white;">ARM AWAY</div>
                    <div id="exitTargetDescMobile" style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Full protection</div>
                </div>
            </div>

            <!-- Countdown Ring -->
            <div id="countdownContainer" style="position: relative; width: 240px; height: 240px;">
                <svg style="width: 100%; height: 100%; transform: rotate(-90deg);" viewBox="0 0 200 200">
                    <circle cx="100" cy="100" r="90" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="4"/>
                    <circle id="countdownProgressMobile" cx="100" cy="100" r="90" fill="none" stroke="url(#countdownGradMobile)" stroke-width="6" stroke-linecap="round" style="stroke-dasharray: 565.5; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear;"/>
                    <defs>
                        <linearGradient id="countdownGradMobile" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#06b6d4"/>
                            <stop offset="50%" stop-color="#8b5cf6"/>
                            <stop offset="100%" stop-color="#ec4899"/>
                        </linearGradient>
                    </defs>
                </svg>
                <div style="position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                    <div id="exitCountdownTimeMobile" style="font-size: 4rem; font-weight: 200; color: white; font-variant-numeric: tabular-nums;">3:00</div>
                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.3); letter-spacing: 0.3em;">UNTIL ARMED</div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 12px; margin-top: 40px; width: 100%;">
                <button data-action="cancelDelayedExit" style="flex: 1; padding: 16px; border-radius: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.7); font-size: 0.875rem; cursor: pointer;">
                    CANCEL
                </button>
                <button data-action="executeExitNow" style="flex: 1; padding: 16px; border-radius: 12px; background: linear-gradient(135deg, #10b981, #14b8a6); border: none; color: white; font-size: 0.875rem; font-weight: 600; cursor: pointer;">
                    ARM NOW
                </button>
            </div>
        </div>
    </div>

    <!-- Critical Alerts Configuration Overlay -->
    <div id="criticalAlertsOverlay" class="hidden" style="position: fixed; inset: 0; z-index: 9999; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);">
        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 24px;">
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 32px;">
                <div style="width: 72px; height: 72px; border-radius: 24px; background: linear-gradient(135deg, #ec4899, #db2777); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px;">
                    <svg style="width: 36px; height: 36px; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                    </svg>
                </div>
                <h2 style="font-size: 1.5rem; font-weight: 700; color: white; margin: 0 0 8px;">Critical Alerts</h2>
                <p style="font-size: 0.875rem; color: rgba(255,255,255,0.5); margin: 0;">Notifications without DSC arming</p>
            </div>

            <!-- Mode Selection -->
            <div style="width: 100%; max-width: 360px; margin-bottom: 24px;">
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 12px;">Alert Zone</div>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                    <button data-action="selectCriticalAlertMode" data-param-mode="outside" id="mCriticalModeOutside" style="padding: 20px 12px; border-radius: 16px; background: rgba(59, 130, 246, 0.1); border: 2px solid rgba(59, 130, 246, 0.3); cursor: pointer; text-align: center;">
                        <svg style="width: 28px; height: 28px; color: #3b82f6; margin: 0 auto 8px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                        </svg>
                        <div style="font-size: 0.875rem; font-weight: 600; color: #3b82f6;">Outside</div>
                        <div style="font-size: 0.625rem; color: rgba(255,255,255,0.4); margin-top: 4px;">Perimeter</div>
                    </button>
                    <button data-action="selectCriticalAlertMode" data-param-mode="stay" id="mCriticalModeStay" style="padding: 20px 12px; border-radius: 16px; background: rgba(245, 158, 11, 0.1); border: 2px solid rgba(245, 158, 11, 0.3); cursor: pointer; text-align: center;">
                        <svg style="width: 28px; height: 28px; color: #f59e0b; margin: 0 auto 8px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        <div style="font-size: 0.875rem; font-weight: 600; color: #f59e0b;">Stay</div>
                        <div style="font-size: 0.625rem; color: rgba(255,255,255,0.4); margin-top: 4px;">+ Downstairs</div>
                    </button>
                    <button data-action="selectCriticalAlertMode" data-param-mode="away" id="mCriticalModeAway" style="padding: 20px 12px; border-radius: 16px; background: rgba(239, 68, 68, 0.1); border: 2px solid rgba(239, 68, 68, 0.3); cursor: pointer; text-align: center;">
                        <svg style="width: 28px; height: 28px; color: #ef4444; margin: 0 auto 8px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <div style="font-size: 0.875rem; font-weight: 600; color: #ef4444;">Away</div>
                        <div style="font-size: 0.625rem; color: rgba(255,255,255,0.4); margin-top: 4px;">All + Blink</div>
                    </button>
                </div>
            </div>

            <!-- Notify Recipients -->
            <div style="width: 100%; max-width: 360px; margin-bottom: 32px;">
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 12px;">Notify</div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                    <button data-action="toggleCriticalNotifyPerson" data-param-person="person1" id="mCriticalNotifyNico" style="padding: 16px; border-radius: 16px; background: rgba(16, 185, 129, 0.1); border: 2px solid rgba(16, 185, 129, 0.3); cursor: pointer; display: flex; align-items: center; gap: 12px;">
                        <div style="width: 44px; height: 44px; border-radius: 12px; background: rgba(16, 185, 129, 0.2); display: flex; align-items: center; justify-content: center;">
                            <svg style="width: 24px; height: 24px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <div style="text-align: left; flex: 1;">
                            <div style="font-size: 1rem; font-weight: 600; color: #10b981;">Person1</div>
                            <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">iPhone</div>
                        </div>
                        <div id="mCriticalNotifyNicoCheck" style="display: none; width: 24px; height: 24px; border-radius: 8px; background: rgba(16, 185, 129, 0.3); align-items: center; justify-content: center;">
                            <svg style="width: 16px; height: 16px; color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                        </div>
                    </button>
                    <button data-action="toggleCriticalNotifyPerson" data-param-person="person2" id="mCriticalNotifyTatiana" style="padding: 16px; border-radius: 16px; background: rgba(168, 85, 247, 0.1); border: 2px solid rgba(168, 85, 247, 0.3); cursor: pointer; display: flex; align-items: center; gap: 12px;">
                        <div style="width: 44px; height: 44px; border-radius: 12px; background: rgba(168, 85, 247, 0.2); display: flex; align-items: center; justify-content: center;">
                            <svg style="width: 24px; height: 24px; color: #a855f7;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <div style="text-align: left; flex: 1;">
                            <div style="font-size: 1rem; font-weight: 600; color: #a855f7;">Person2</div>
                            <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">iPhone</div>
                        </div>
                        <div id="mCriticalNotifyTatianaCheck" style="display: none; width: 24px; height: 24px; border-radius: 8px; background: rgba(168, 85, 247, 0.3); align-items: center; justify-content: center;">
                            <svg style="width: 16px; height: 16px; color: #a855f7;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="display: flex; gap: 12px; width: 100%; max-width: 360px;">
                <button data-action="disableCriticalAlerts" style="flex: 1; padding: 16px; border-radius: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.7); font-size: 0.9375rem; cursor: pointer;">
                    Turn Off
                </button>
                <button data-action="applyCriticalAlerts" style="flex: 1; padding: 16px; border-radius: 12px; background: linear-gradient(135deg, #ec4899, #db2777); border: none; color: white; font-size: 0.9375rem; font-weight: 600; cursor: pointer;">
                    Apply
                </button>
            </div>

            <!-- Close button -->
            <button data-action="closeCriticalAlertsConfig" style="margin-top: 24px; padding: 12px 24px; border-radius: 12px; background: none; border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.5); font-size: 0.875rem; cursor: pointer;">
                Cancel
            </button>

            <!-- Info -->
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.3); text-align: center; margin-top: 16px; max-width: 280px;">
                Critical alerts send push notifications with images but don't arm the physical DSC alarm
            </p>
        </div>
    </div>

    <!-- Version Check & Auto-Refresh (runs before main app) -->
    <script>
    (function() {
        const CURRENT_VERSION = '2026.01.15.1';
        const VERSION_CHECK_INTERVAL = 60000; // Check every 60 seconds
        const VERSION_URL = '/local/dashboard/version.json';

        // Store version in localStorage
        const storedVersion = localStorage.getItem('dashboard_version');

        async function checkVersion() {
            try {
                // Add cache-busting timestamp to version check
                const response = await fetch(VERSION_URL + '?t=' + Date.now(), {
                    cache: 'no-store',
                    headers: { 'Cache-Control': 'no-cache' }
                });
                if (!response.ok) return;

                const data = await response.json();
                const serverVersion = data.version;

                // If server version differs from our current version, reload
                if (serverVersion && serverVersion !== CURRENT_VERSION) {
                    console.log('[Version] Update detected:', CURRENT_VERSION, '->', serverVersion);
                    // Clear all caches we can access
                    if ('caches' in window) {
                        const keys = await caches.keys();
                        await Promise.all(keys.map(key => caches.delete(key)));
                    }
                    // Force reload bypassing cache
                    window.location.reload(true);
                }
            } catch (e) {
                console.warn('[Version] Check failed:', e.message);
            }
        }

        // Check on load (after a small delay to not block initial render)
        setTimeout(checkVersion, 3000);

        // Periodic check while app is running
        setInterval(checkVersion, VERSION_CHECK_INTERVAL);

        // Also check when app becomes visible again (user returns to tab)
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible') {
                checkVersion();
            }
        });

        // Store current version
        if (storedVersion !== CURRENT_VERSION) {
            localStorage.setItem('dashboard_version', CURRENT_VERSION);
            console.log('[Version] Updated to', CURRENT_VERSION);
        }
    })();
    </script>

    <!-- Main Application Script -->
    <script type="module" src="js/main-mobile.js?v=2026.01.15.1"></script>
</body>
</html>
