<!DOCTYPE html>
<html>
<head>
    <title>Weather Test</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="css/weather.css">
    <style>
        body { background: #0a0a12; min-height: 100vh; }
    </style>
</head>
<body>
    <!-- Include the weather view directly -->
    <div id="view-weather" class="h-screen weather-view-futuristic">
        <!-- Animated Weather Background -->
        <div class="weather-bg-container">
            <div class="weather-grid-bg"></div>
            <div class="weather-scan-line"></div>
            <canvas id="weatherParticles" class="weather-particles-canvas"></canvas>
            <div class="weather-ambient-glow"></div>
        </div>

        <div class="h-full flex flex-col p-4 relative z-10">
            <!-- Header -->
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-4">
                    <div class="weather-logo-container">
                        <div class="weather-logo-ring"></div>
                        <div id="weatherHeaderIcon" class="weather-logo-icon">
                            <svg class="w-6 h-6 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"/>
                            </svg>
                        </div>
                    </div>
                    <div>
                        <h2 class="text-xl font-light tracking-wide text-white/90">WEATHER COMMAND</h2>
                        <p id="weatherLastUpdate" class="text-cyan-400/60 text-xs font-mono">INITIALIZING...</p>
                    </div>
                </div>
                <div class="weather-location-badge">
                    <svg class="w-3 h-3 text-cyan-400" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                    <span class="text-[10px] text-white/60 uppercase tracking-wider">Johannesburg</span>
                </div>
            </div>

            <!-- Main Grid Layout -->
            <div class="flex-1 grid grid-cols-12 grid-rows-6 gap-3 min-h-0">
                <!-- HERO: Current Conditions -->
                <div class="col-span-4 row-span-3 weather-card-neo weather-card-hero">
                    <div class="h-full flex flex-col">
                        <div class="flex-1 flex items-center justify-center gap-6">
                            <div id="currentWeatherIcon" class="weather-icon-large">
                                <svg class="w-24 h-24 text-amber-400" fill="currentColor" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="5"/>
                                </svg>
                            </div>
                            <div class="text-center">
                                <div class="weather-temp-display">
                                    <span id="currentTemp" class="weather-temp-value">--</span>
                                    <span class="weather-temp-unit">°C</span>
                                </div>
                                <div id="currentCondition" class="text-lg text-white/70 font-light">Loading...</div>
                                <div class="flex items-center justify-center gap-3 mt-2">
                                    <span class="text-sm text-white/40">Feels like</span>
                                    <span id="feelsLike" class="text-sm text-cyan-400 font-mono">--°</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-center gap-8 pb-4">
                            <div class="text-center">
                                <div class="text-[10px] text-white/40 uppercase tracking-wider">High</div>
                                <div id="todayHigh" class="text-xl font-light text-amber-400">--°</div>
                            </div>
                            <div class="weather-temp-divider"></div>
                            <div class="text-center">
                                <div class="text-[10px] text-white/40 uppercase tracking-wider">Low</div>
                                <div id="todayLow" class="text-xl font-light text-blue-400">--°</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AIR QUALITY -->
                <div class="col-span-4 row-span-3 weather-card-neo weather-card-aqi">
                    <div class="weather-card-header">
                        <span class="weather-card-label">AIR QUALITY INDEX</span>
                        <span id="aqiStatus" class="weather-status-dot"></span>
                    </div>
                    <div class="flex-1 flex flex-col">
                        <div class="flex items-center justify-center gap-6 py-3">
                            <div class="aqi-gauge-large">
                                <svg class="w-full h-full" viewBox="0 0 100 100">
                                    <defs>
                                        <linearGradient id="aqiGradient" x1="0%" y1="100%" x2="100%" y2="0%">
                                            <stop offset="0%" stop-color="#22c55e"/>
                                            <stop offset="25%" stop-color="#eab308"/>
                                            <stop offset="50%" stop-color="#f97316"/>
                                            <stop offset="75%" stop-color="#ef4444"/>
                                            <stop offset="100%" stop-color="#a855f7"/>
                                        </linearGradient>
                                    </defs>
                                    <circle cx="50" cy="50" r="42" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="10"/>
                                    <circle id="aqiRing" cx="50" cy="50" r="42" fill="none" stroke="url(#aqiGradient)" stroke-width="10"
                                        stroke-linecap="round" stroke-dasharray="264" stroke-dashoffset="264"
                                        transform="rotate(-90 50 50)" class="aqi-ring-animated"/>
                                </svg>
                                <div class="aqi-gauge-value">
                                    <span id="aqiValue" class="text-4xl font-light text-white">--</span>
                                    <span id="aqiLabel" class="text-xs text-emerald-400 font-medium">Loading</span>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2 px-1">
                            <div class="pollutant-card-compact">
                                <span class="pollutant-icon pm25">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/></svg>
                                </span>
                                <div class="pollutant-data">
                                    <span id="pm25Value" class="pollutant-val">--</span>
                                    <span class="pollutant-lbl">PM2.5</span>
                                </div>
                            </div>
                            <div class="pollutant-card-compact">
                                <span class="pollutant-icon pm10">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg>
                                </span>
                                <div class="pollutant-data">
                                    <span id="pm10Value" class="pollutant-val">--</span>
                                    <span class="pollutant-lbl">PM10</span>
                                </div>
                            </div>
                            <div class="pollutant-card-compact">
                                <span class="pollutant-icon ozone">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5" stroke-width="1.5"/></svg>
                                </span>
                                <div class="pollutant-data">
                                    <span id="o3Value" class="pollutant-val">--</span>
                                    <span class="pollutant-lbl">O₃</span>
                                </div>
                            </div>
                            <div class="pollutant-card-compact">
                                <span class="pollutant-icon no2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/></svg>
                                </span>
                                <div class="pollutant-data">
                                    <span id="no2Value" class="pollutant-val">--</span>
                                    <span class="pollutant-lbl">NO₂</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="aqiAdvice" class="aqi-advice-bar">
                        <svg class="w-4 h-4 text-emerald-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        <span class="text-white/60 text-xs">Analyzing air quality...</span>
                    </div>
                </div>

                <!-- ATMOSPHERIC METRICS -->
                <div class="col-span-4 row-span-3 grid grid-cols-2 grid-rows-3 gap-2">
                    <div class="weather-card-neo weather-card-metric">
                        <div class="metric-icon humidity"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.69l5.66 5.66a8 8 0 11-11.31 0z"/></svg></div>
                        <div class="metric-content">
                            <div id="humidityValue" class="metric-value">--%</div>
                            <div class="metric-label">Humidity</div>
                        </div>
                    </div>
                    <div class="weather-card-neo weather-card-metric">
                        <div class="wind-compass-container">
                            <svg class="wind-compass" viewBox="0 0 40 40">
                                <circle cx="20" cy="20" r="18" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
                                <path id="windArrow" d="M20 5 L23 15 L20 12 L17 15 Z" fill="#06b6d4" transform="rotate(0 20 20)"/>
                            </svg>
                        </div>
                        <div class="metric-content">
                            <div id="windValue" class="metric-value">-- km/h</div>
                            <div class="metric-label">Wind</div>
                        </div>
                    </div>
                    <div class="weather-card-neo weather-card-metric">
                        <div class="metric-icon pressure"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg></div>
                        <div class="metric-content">
                            <div id="pressureValue" class="metric-value">-- hPa</div>
                            <div class="metric-label">Pressure</div>
                        </div>
                    </div>
                    <div class="weather-card-neo weather-card-metric">
                        <div class="metric-icon visibility"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg></div>
                        <div class="metric-content">
                            <div id="visibilityValue" class="metric-value">-- km</div>
                            <div class="metric-label">Visibility</div>
                        </div>
                    </div>
                    <div class="weather-card-neo weather-card-metric">
                        <div class="metric-icon uv"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg></div>
                        <div class="metric-content">
                            <div id="uvValue" class="metric-value">--</div>
                            <div class="metric-label">UV Index</div>
                        </div>
                    </div>
                    <div class="weather-card-neo weather-card-metric">
                        <div class="metric-icon cloud"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/></svg></div>
                        <div class="metric-content">
                            <div id="cloudValue" class="metric-value">--%</div>
                            <div class="metric-label">Clouds</div>
                        </div>
                    </div>
                </div>

                <!-- HOURLY FORECAST -->
                <div class="col-span-8 row-span-2 weather-card-neo weather-card-hourly">
                    <div class="weather-card-header mb-2">
                        <span class="weather-card-label">24-HOUR FORECAST</span>
                    </div>
                    <div id="hourlyScroll" class="hourly-scroll-container">
                        <div class="text-white/50 text-sm p-4">Loading forecast...</div>
                    </div>
                </div>

                <!-- RADAR MAP -->
                <div class="col-span-4 row-span-2 weather-card-neo weather-card-radar">
                    <div class="weather-card-header">
                        <span class="weather-card-label">PRECIPITATION RADAR</span>
                        <button id="radarPlayBtn" class="radar-control-btn" title="Play/Pause">
                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                    </div>
                    <div id="radarMap" class="radar-map-container">
                        <div class="radar-loading">
                            <div class="radar-loading-spinner"></div>
                            <span>Loading radar...</span>
                        </div>
                    </div>
                </div>

                <!-- 7-DAY FORECAST -->
                <div class="col-span-6 row-span-1 weather-card-neo weather-card-weekly">
                    <div class="weather-card-header">
                        <span class="weather-card-label">7-DAY FORECAST</span>
                    </div>
                    <div id="weeklyForecast" class="weekly-forecast-container">
                        <div class="text-white/50 text-sm">Loading...</div>
                    </div>
                </div>

                <!-- SUN TIMES -->
                <div class="col-span-3 row-span-1 weather-card-neo weather-card-sun">
                    <div class="flex items-center justify-between h-full px-2">
                        <div class="sun-time-item">
                            <svg class="w-5 h-5 text-amber-400" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg>
                            <div class="text-[10px] text-white/40 uppercase">Sunrise</div>
                            <div id="sunriseTime" class="text-sm font-mono text-amber-400">--:--</div>
                        </div>
                        <div class="sun-arc-container">
                            <svg class="sun-arc" viewBox="0 0 100 50">
                                <path d="M 5 45 Q 50 -10 95 45" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="2"/>
                                <path id="sunArcProgress" d="M 5 45 Q 50 -10 95 45" fill="none" stroke="#fbbf24" stroke-width="2" stroke-dasharray="140" stroke-dashoffset="140"/>
                                <circle id="sunPosition" cx="5" cy="45" r="4" fill="#fbbf24"/>
                            </svg>
                        </div>
                        <div class="sun-time-item">
                            <svg class="w-5 h-5 text-orange-400" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/></svg>
                            <div class="text-[10px] text-white/40 uppercase">Sunset</div>
                            <div id="sunsetTime" class="text-sm font-mono text-orange-400">--:--</div>
                        </div>
                    </div>
                </div>

                <!-- HISTORICAL -->
                <div class="col-span-3 row-span-1 weather-card-neo weather-card-history">
                    <div class="weather-card-header">
                        <span class="weather-card-label">VS YESTERDAY</span>
                    </div>
                    <div class="flex items-center justify-around h-full">
                        <div class="history-compare-item">
                            <div id="tempDiff" class="history-diff positive">+0°</div>
                            <div class="text-[9px] text-white/40 uppercase">Temp</div>
                        </div>
                        <div class="history-divider"></div>
                        <div class="history-compare-item">
                            <div id="humidityDiff" class="history-diff neutral">0%</div>
                            <div class="text-[9px] text-white/40 uppercase">Humidity</div>
                        </div>
                        <div class="history-divider"></div>
                        <div class="history-compare-item">
                            <div id="windDiff" class="history-diff negative">-0</div>
                            <div class="text-[9px] text-white/40 uppercase">Wind</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weather Alerts Bar -->
            <div id="weatherAlertsBar" class="weather-alerts-bar hidden">
                <div class="alert-icon">
                    <svg class="w-4 h-4 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                    </svg>
                </div>
                <div id="alertText" class="alert-text">No active alerts</div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initWeather } from './js/weather.js';

        // Initialize immediately since view is already visible
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Test page loaded, initializing weather...');
            initWeather();
        });
    </script>
</body>
</html>
